<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Project Ne10: /home/philwong/Ne10-gerrit/modules/dsp/NE10_rfft_float32.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="ne10_logo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Project Ne10
   
   </div>
   <div id="projectbrief">An Open Optimized Software Library Project for the ARM Architecture</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">/home/philwong/Ne10-gerrit/modules/dsp/NE10_rfft_float32.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> *  Copyright 2014 ARM Limited and Contributors.</span>
<a name="l00003"></a>00003 <span class="comment"> *  All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> *  Redistribution and use in source and binary forms, with or without</span>
<a name="l00006"></a>00006 <span class="comment"> *  modification, are permitted provided that the following conditions are met:</span>
<a name="l00007"></a>00007 <span class="comment"> *    * Redistributions of source code must retain the above copyright</span>
<a name="l00008"></a>00008 <span class="comment"> *      notice, this list of conditions and the following disclaimer.</span>
<a name="l00009"></a>00009 <span class="comment"> *    * Redistributions in binary form must reproduce the above copyright</span>
<a name="l00010"></a>00010 <span class="comment"> *      notice, this list of conditions and the following disclaimer in the</span>
<a name="l00011"></a>00011 <span class="comment"> *      documentation and/or other materials provided with the distribution.</span>
<a name="l00012"></a>00012 <span class="comment"> *    * Neither the name of ARM Limited nor the</span>
<a name="l00013"></a>00013 <span class="comment"> *      names of its contributors may be used to endorse or promote products</span>
<a name="l00014"></a>00014 <span class="comment"> *      derived from this software without specific prior written permission.</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> *  THIS SOFTWARE IS PROVIDED BY ARM LIMITED AND CONTRIBUTORS &quot;AS IS&quot; AND</span>
<a name="l00017"></a>00017 <span class="comment"> *  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED</span>
<a name="l00018"></a>00018 <span class="comment"> *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<a name="l00019"></a>00019 <span class="comment"> *  DISCLAIMED. IN NO EVENT SHALL ARM LIMITED AND CONTRIBUTORS BE LIABLE FOR ANY</span>
<a name="l00020"></a>00020 <span class="comment"> *  DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span>
<a name="l00021"></a>00021 <span class="comment"> *  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</span>
<a name="l00022"></a>00022 <span class="comment"> *  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND</span>
<a name="l00023"></a>00023 <span class="comment"> *  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00024"></a>00024 <span class="comment"> *  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS</span>
<a name="l00025"></a>00025 <span class="comment"> *  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00026"></a>00026 <span class="comment"> */</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="comment">/* license of Kiss FFT */</span>
<a name="l00029"></a>00029 <span class="comment">/*</span>
<a name="l00030"></a>00030 <span class="comment">Copyright (c) 2003-2010, Mark Borgerding</span>
<a name="l00031"></a>00031 <span class="comment"></span>
<a name="l00032"></a>00032 <span class="comment">All rights reserved.</span>
<a name="l00033"></a>00033 <span class="comment"></span>
<a name="l00034"></a>00034 <span class="comment">Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00035"></a>00035 <span class="comment"></span>
<a name="l00036"></a>00036 <span class="comment">    * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00037"></a>00037 <span class="comment">    * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00038"></a>00038 <span class="comment">    * Neither the author nor the names of any contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00039"></a>00039 <span class="comment"></span>
<a name="l00040"></a>00040 <span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00041"></a>00041 <span class="comment">*/</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="comment">/*</span>
<a name="l00044"></a>00044 <span class="comment"> * NE10 Library : dsp/NE10_rfft_float32.c</span>
<a name="l00045"></a>00045 <span class="comment"> */</span>
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;NE10_types.h&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;NE10_macros.h&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;NE10_fft.h&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;NE10_dsp.h&quot;</span>
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="preprocessor">#if defined(__aarch64__)</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span>
<a name="l00054"></a>00054 <span class="keywordtype">void</span> ne10_radix8_r2c_c (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fout,
<a name="l00055"></a>00055                         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fin,
<a name="l00056"></a>00056                         <span class="keyword">const</span> ne10_int32_t fstride,
<a name="l00057"></a>00057                         <span class="keyword">const</span> ne10_int32_t mstride,
<a name="l00058"></a>00058                         <span class="keyword">const</span> ne10_int32_t nfft)
<a name="l00059"></a>00059 {
<a name="l00060"></a>00060     <span class="keyword">const</span> ne10_int32_t in_step = nfft &gt;&gt; 3;
<a name="l00061"></a>00061           ne10_int32_t f_count;
<a name="l00062"></a>00062 
<a name="l00063"></a>00063     ne10_float32_t scratch_in[8];
<a name="l00064"></a>00064     ne10_float32_t scratch   [4];
<a name="l00065"></a>00065 
<a name="l00066"></a>00066     <span class="comment">/* real pointers */</span>
<a name="l00067"></a>00067     <span class="keyword">const</span> ne10_float32_t* Fin_r  = (ne10_float32_t*) Fin;
<a name="l00068"></a>00068           ne10_float32_t* Fout_r = (ne10_float32_t*) Fout;
<a name="l00069"></a>00069     Fout_r ++; <span class="comment">// always leave the first real empty</span>
<a name="l00070"></a>00070 
<a name="l00071"></a>00071     <span class="keywordflow">for</span> (f_count = fstride; f_count; f_count --)
<a name="l00072"></a>00072     {
<a name="l00073"></a>00073         scratch_in[0] = Fin_r[in_step * 0] + Fin_r[in_step * (0 + 4)];
<a name="l00074"></a>00074         scratch_in[1] = Fin_r[in_step * 0] - Fin_r[in_step * (0 + 4)];
<a name="l00075"></a>00075         scratch_in[2] = Fin_r[in_step * 1] + Fin_r[in_step * (1 + 4)];
<a name="l00076"></a>00076         scratch_in[3] = Fin_r[in_step * 1] - Fin_r[in_step * (1 + 4)];
<a name="l00077"></a>00077         scratch_in[4] = Fin_r[in_step * 2] + Fin_r[in_step * (2 + 4)];
<a name="l00078"></a>00078         scratch_in[5] = Fin_r[in_step * 2] - Fin_r[in_step * (2 + 4)];
<a name="l00079"></a>00079         scratch_in[6] = Fin_r[in_step * 3] + Fin_r[in_step * (3 + 4)];
<a name="l00080"></a>00080         scratch_in[7] = Fin_r[in_step * 3] - Fin_r[in_step * (3 + 4)];
<a name="l00081"></a>00081 
<a name="l00082"></a>00082         scratch_in[3] *= TW_81_F32;
<a name="l00083"></a>00083         scratch_in[7] *= TW_81N_F32;
<a name="l00084"></a>00084 
<a name="l00085"></a>00085         <span class="comment">// radix 2 butterfly</span>
<a name="l00086"></a>00086         scratch[0] =   scratch_in[0] + scratch_in[4];
<a name="l00087"></a>00087         scratch[1] =   scratch_in[2] + scratch_in[6];
<a name="l00088"></a>00088         scratch[2] =   scratch_in[7] - scratch_in[3];
<a name="l00089"></a>00089         scratch[3] =   scratch_in[3] + scratch_in[7];
<a name="l00090"></a>00090 
<a name="l00091"></a>00091         Fout_r[0] = scratch   [0] + scratch   [1];
<a name="l00092"></a>00092         Fout_r[7] = scratch   [0] - scratch   [1];
<a name="l00093"></a>00093 
<a name="l00094"></a>00094         Fout_r[1] = scratch_in[1] + scratch   [3];
<a name="l00095"></a>00095         Fout_r[5] = scratch_in[1] - scratch   [3];
<a name="l00096"></a>00096 
<a name="l00097"></a>00097         Fout_r[2] = scratch   [2] - scratch_in[5];
<a name="l00098"></a>00098         Fout_r[6] = scratch   [2] + scratch_in[5];
<a name="l00099"></a>00099 
<a name="l00100"></a>00100         Fout_r[3] = scratch_in[0] - scratch_in[4];
<a name="l00101"></a>00101 
<a name="l00102"></a>00102         Fout_r[4] = scratch_in[6] - scratch_in[2];
<a name="l00103"></a>00103 
<a name="l00104"></a>00104         Fin_r  ++;
<a name="l00105"></a>00105         Fout_r += 8;
<a name="l00106"></a>00106     }
<a name="l00107"></a>00107 }
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 <span class="keywordtype">void</span> ne10_radix8_c2r_c (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fout,
<a name="l00110"></a>00110                         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fin,
<a name="l00111"></a>00111                         <span class="keyword">const</span> ne10_int32_t fstride,
<a name="l00112"></a>00112                         <span class="keyword">const</span> ne10_int32_t mstride,
<a name="l00113"></a>00113                         <span class="keyword">const</span> ne10_int32_t nfft)
<a name="l00114"></a>00114 {
<a name="l00115"></a>00115     <span class="keyword">const</span> ne10_int32_t in_step = nfft &gt;&gt; 3;
<a name="l00116"></a>00116           ne10_int32_t f_count;
<a name="l00117"></a>00117 
<a name="l00118"></a>00118     ne10_float32_t scratch_in[8];
<a name="l00119"></a>00119 
<a name="l00120"></a>00120     <span class="keyword">const</span> ne10_float32_t one_by_N = 1.0 / nfft;
<a name="l00121"></a>00121 
<a name="l00122"></a>00122     <span class="comment">/* real pointers */</span>
<a name="l00123"></a>00123     <span class="keyword">const</span> ne10_float32_t* Fin_r  = (ne10_float32_t*) Fin;
<a name="l00124"></a>00124           ne10_float32_t* Fout_r = (ne10_float32_t*) Fout;
<a name="l00125"></a>00125 
<a name="l00126"></a>00126     <span class="keywordflow">for</span> (f_count = fstride; f_count; f_count --)
<a name="l00127"></a>00127     {
<a name="l00128"></a>00128         scratch_in[0] =   Fin_r[0] + Fin_r[3] + Fin_r[3] + Fin_r[7];
<a name="l00129"></a>00129         scratch_in[1] =   Fin_r[1] + Fin_r[1] + Fin_r[5] + Fin_r[5];
<a name="l00130"></a>00130         scratch_in[2] =   Fin_r[0] - Fin_r[4] - Fin_r[4] - Fin_r[7];
<a name="l00131"></a>00131         scratch_in[3] =   Fin_r[1] - Fin_r[2] - Fin_r[5] - Fin_r[6];
<a name="l00132"></a>00132         scratch_in[4] =   Fin_r[0] - Fin_r[3] - Fin_r[3] + Fin_r[7];
<a name="l00133"></a>00133         scratch_in[5] = - Fin_r[2] - Fin_r[2] + Fin_r[6] + Fin_r[6];
<a name="l00134"></a>00134         scratch_in[6] =   Fin_r[0] + Fin_r[4] + Fin_r[4] - Fin_r[7];
<a name="l00135"></a>00135         scratch_in[7] =   Fin_r[1] + Fin_r[2] - Fin_r[5] + Fin_r[6];
<a name="l00136"></a>00136 
<a name="l00137"></a>00137         scratch_in[3] /= TW_81_F32;
<a name="l00138"></a>00138         scratch_in[7] /= TW_81N_F32;
<a name="l00139"></a>00139 
<a name="l00140"></a>00140         Fout_r[0 * in_step] = scratch_in[0] + scratch_in[1];
<a name="l00141"></a>00141         Fout_r[4 * in_step] = scratch_in[0] - scratch_in[1];
<a name="l00142"></a>00142         Fout_r[1 * in_step] = scratch_in[2] + scratch_in[3];
<a name="l00143"></a>00143         Fout_r[5 * in_step] = scratch_in[2] - scratch_in[3];
<a name="l00144"></a>00144         Fout_r[2 * in_step] = scratch_in[4] + scratch_in[5];
<a name="l00145"></a>00145         Fout_r[6 * in_step] = scratch_in[4] - scratch_in[5];
<a name="l00146"></a>00146         Fout_r[3 * in_step] = scratch_in[6] + scratch_in[7];
<a name="l00147"></a>00147         Fout_r[7 * in_step] = scratch_in[6] - scratch_in[7];
<a name="l00148"></a>00148 
<a name="l00149"></a>00149 <span class="preprocessor">#if defined(NE10_DSP_RFFT_SCALING)</span>
<a name="l00150"></a>00150 <span class="preprocessor"></span>        Fout_r[0 * in_step] *= one_by_N;
<a name="l00151"></a>00151         Fout_r[4 * in_step] *= one_by_N;
<a name="l00152"></a>00152         Fout_r[1 * in_step] *= one_by_N;
<a name="l00153"></a>00153         Fout_r[5 * in_step] *= one_by_N;
<a name="l00154"></a>00154         Fout_r[2 * in_step] *= one_by_N;
<a name="l00155"></a>00155         Fout_r[6 * in_step] *= one_by_N;
<a name="l00156"></a>00156         Fout_r[3 * in_step] *= one_by_N;
<a name="l00157"></a>00157         Fout_r[7 * in_step] *= one_by_N;
<a name="l00158"></a>00158 <span class="preprocessor">#endif</span>
<a name="l00159"></a>00159 <span class="preprocessor"></span>
<a name="l00160"></a>00160         Fin_r  += 8;
<a name="l00161"></a>00161         Fout_r ++;
<a name="l00162"></a>00162     }
<a name="l00163"></a>00163 }
<a name="l00164"></a>00164 
<a name="l00165"></a>00165 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4_r2c_c (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fout,
<a name="l00166"></a>00166                                   <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fin,
<a name="l00167"></a>00167                                   <span class="keyword">const</span> ne10_int32_t fstride,
<a name="l00168"></a>00168                                   <span class="keyword">const</span> ne10_int32_t mstride,
<a name="l00169"></a>00169                                   <span class="keyword">const</span> ne10_int32_t nfft)
<a name="l00170"></a>00170 {
<a name="l00171"></a>00171     <span class="keyword">const</span> ne10_int32_t in_step = nfft &gt;&gt; 2;
<a name="l00172"></a>00172           ne10_int32_t f_count;
<a name="l00173"></a>00173 
<a name="l00174"></a>00174     ne10_float32_t  scratch_in [4];
<a name="l00175"></a>00175     ne10_float32_t  scratch_out[4];
<a name="l00176"></a>00176 
<a name="l00177"></a>00177     <span class="comment">/* real pointers */</span>
<a name="l00178"></a>00178     <span class="keyword">const</span> ne10_float32_t *Fin_r  = (ne10_float32_t*) Fin;
<a name="l00179"></a>00179           ne10_float32_t *Fout_r = (ne10_float32_t*) Fout;
<a name="l00180"></a>00180     Fout_r ++; <span class="comment">// always leave the first real empty</span>
<a name="l00181"></a>00181 
<a name="l00182"></a>00182     <span class="keywordflow">for</span> (f_count = fstride; f_count; f_count --)
<a name="l00183"></a>00183     {
<a name="l00184"></a>00184         scratch_in[0] = Fin_r[0 * in_step];
<a name="l00185"></a>00185         scratch_in[1] = Fin_r[1 * in_step];
<a name="l00186"></a>00186         scratch_in[2] = Fin_r[2 * in_step];
<a name="l00187"></a>00187         scratch_in[3] = Fin_r[3 * in_step];
<a name="l00188"></a>00188 
<a name="l00189"></a>00189         <span class="comment">// NE10_PRINT_Q_VECTOR(scratch_in);</span>
<a name="l00190"></a>00190 
<a name="l00191"></a>00191         NE10_FFT_R2C_4R_RCR(scratch_out,scratch_in);
<a name="l00192"></a>00192 
<a name="l00193"></a>00193         <span class="comment">// NE10_PRINT_Q_VECTOR(scratch_out);</span>
<a name="l00194"></a>00194 
<a name="l00195"></a>00195         Fout_r[0] = scratch_out[0];
<a name="l00196"></a>00196         Fout_r[1] = scratch_out[1];
<a name="l00197"></a>00197         Fout_r[2] = scratch_out[2];
<a name="l00198"></a>00198         Fout_r[3] = scratch_out[3];
<a name="l00199"></a>00199 
<a name="l00200"></a>00200         Fin_r  ++;
<a name="l00201"></a>00201         Fout_r += 4;
<a name="l00202"></a>00202     }
<a name="l00203"></a>00203 }
<a name="l00204"></a>00204 
<a name="l00205"></a>00205 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4_c2r_c (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fout,
<a name="l00206"></a>00206                                   <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fin,
<a name="l00207"></a>00207                                   <span class="keyword">const</span> ne10_int32_t fstride,
<a name="l00208"></a>00208                                   <span class="keyword">const</span> ne10_int32_t mstride,
<a name="l00209"></a>00209                                   <span class="keyword">const</span> ne10_int32_t nfft)
<a name="l00210"></a>00210 {
<a name="l00211"></a>00211     ne10_int32_t f_count;
<a name="l00212"></a>00212     <span class="keyword">const</span> ne10_int32_t in_step = nfft &gt;&gt; 2;
<a name="l00213"></a>00213     ne10_float32_t  scratch_in [4];
<a name="l00214"></a>00214     ne10_float32_t  scratch_out[4];
<a name="l00215"></a>00215 
<a name="l00216"></a>00216     <span class="keyword">const</span> ne10_float32_t one_by_N = 1.0 / nfft;
<a name="l00217"></a>00217 
<a name="l00218"></a>00218     <span class="comment">/* real pointers */</span>
<a name="l00219"></a>00219     <span class="keyword">const</span> ne10_float32_t *Fin_r  = (ne10_float32_t*) Fin;
<a name="l00220"></a>00220           ne10_float32_t *Fout_r = (ne10_float32_t*) Fout;
<a name="l00221"></a>00221 
<a name="l00222"></a>00222     <span class="keywordflow">for</span> (f_count = fstride; f_count; f_count --)
<a name="l00223"></a>00223     {
<a name="l00224"></a>00224         scratch_in[0] = Fin_r[0];
<a name="l00225"></a>00225         scratch_in[1] = Fin_r[1];
<a name="l00226"></a>00226         scratch_in[2] = Fin_r[2];
<a name="l00227"></a>00227         scratch_in[3] = Fin_r[3];
<a name="l00228"></a>00228 
<a name="l00229"></a>00229         <span class="comment">// NE10_PRINT_Q_VECTOR(scratch_in);</span>
<a name="l00230"></a>00230 
<a name="l00231"></a>00231         NE10_FFT_C2R_RCR_4R(scratch_out,scratch_in);
<a name="l00232"></a>00232 
<a name="l00233"></a>00233         <span class="comment">// NE10_PRINT_Q_VECTOR(scratch_out);</span>
<a name="l00234"></a>00234 
<a name="l00235"></a>00235 <span class="preprocessor">#if defined(NE10_DSP_RFFT_SCALING)</span>
<a name="l00236"></a>00236 <span class="preprocessor"></span>        scratch_out[0] *= one_by_N;
<a name="l00237"></a>00237         scratch_out[1] *= one_by_N;
<a name="l00238"></a>00238         scratch_out[2] *= one_by_N;
<a name="l00239"></a>00239         scratch_out[3] *= one_by_N;
<a name="l00240"></a>00240 <span class="preprocessor">#endif</span>
<a name="l00241"></a>00241 <span class="preprocessor"></span>
<a name="l00242"></a>00242         <span class="comment">// store</span>
<a name="l00243"></a>00243         Fout_r[0 * in_step] = scratch_out[0];
<a name="l00244"></a>00244         Fout_r[1 * in_step] = scratch_out[1];
<a name="l00245"></a>00245         Fout_r[2 * in_step] = scratch_out[2];
<a name="l00246"></a>00246         Fout_r[3 * in_step] = scratch_out[3];
<a name="l00247"></a>00247 
<a name="l00248"></a>00248         Fin_r  += 4;
<a name="l00249"></a>00249         Fout_r ++;
<a name="l00250"></a>00250     }
<a name="l00251"></a>00251 }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4_r2c_with_twiddles_first_butterfly_c (ne10_float32_t *Fout_r,
<a name="l00254"></a>00254         <span class="keyword">const</span> ne10_float32_t *Fin_r,
<a name="l00255"></a>00255         <span class="keyword">const</span> ne10_int32_t out_step,
<a name="l00256"></a>00256         <span class="keyword">const</span> ne10_int32_t in_step,
<a name="l00257"></a>00257         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles)
<a name="l00258"></a>00258 {
<a name="l00259"></a>00259     ne10_float32_t scratch_out[4];
<a name="l00260"></a>00260     ne10_float32_t scratch_in [4];
<a name="l00261"></a>00261 
<a name="l00262"></a>00262     <span class="comment">// load</span>
<a name="l00263"></a>00263     scratch_in[0] = Fin_r[0 * in_step];
<a name="l00264"></a>00264     scratch_in[1] = Fin_r[1 * in_step];
<a name="l00265"></a>00265     scratch_in[2] = Fin_r[2 * in_step];
<a name="l00266"></a>00266     scratch_in[3] = Fin_r[3 * in_step];
<a name="l00267"></a>00267 
<a name="l00268"></a>00268     <span class="comment">// NE10_PRINT_Q_VECTOR(scratch_in);</span>
<a name="l00269"></a>00269 
<a name="l00270"></a>00270     NE10_FFT_R2C_4R_RCR(scratch_out,scratch_in);
<a name="l00271"></a>00271 
<a name="l00272"></a>00272     <span class="comment">// NE10_PRINT_Q_VECTOR(scratch_out);</span>
<a name="l00273"></a>00273 
<a name="l00274"></a>00274     <span class="comment">// store</span>
<a name="l00275"></a>00275     Fout_r[                      0] = scratch_out[0];
<a name="l00276"></a>00276     Fout_r[    (out_step &lt;&lt; 1) - 1] = scratch_out[1];
<a name="l00277"></a>00277     Fout_r[    (out_step &lt;&lt; 1)    ] = scratch_out[2];
<a name="l00278"></a>00278     Fout_r[2 * (out_step &lt;&lt; 1) - 1] = scratch_out[3];
<a name="l00279"></a>00279 }
<a name="l00280"></a>00280 
<a name="l00281"></a>00281 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4_c2r_with_twiddles_first_butterfly_c (ne10_float32_t *Fout_r,
<a name="l00282"></a>00282         <span class="keyword">const</span> ne10_float32_t *Fin_r,
<a name="l00283"></a>00283         <span class="keyword">const</span> ne10_int32_t out_step,
<a name="l00284"></a>00284         <span class="keyword">const</span> ne10_int32_t in_step,
<a name="l00285"></a>00285         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles)
<a name="l00286"></a>00286 {
<a name="l00287"></a>00287     ne10_float32_t scratch      [8];
<a name="l00288"></a>00288     ne10_float32_t scratch_in_r [4];
<a name="l00289"></a>00289     ne10_float32_t scratch_out_r[4];
<a name="l00290"></a>00290 
<a name="l00291"></a>00291     <span class="comment">// load</span>
<a name="l00292"></a>00292     scratch_in_r[0] = Fin_r[0                ];
<a name="l00293"></a>00293     scratch_in_r[1] = Fin_r[1*(out_step&lt;&lt;1)-1];
<a name="l00294"></a>00294     scratch_in_r[2] = Fin_r[1*(out_step&lt;&lt;1)  ];
<a name="l00295"></a>00295     scratch_in_r[3] = Fin_r[2*(out_step&lt;&lt;1)-1];
<a name="l00296"></a>00296 
<a name="l00297"></a>00297     <span class="comment">// NE10_PRINT_Q_VECTOR(scratch_in_r);</span>
<a name="l00298"></a>00298 
<a name="l00299"></a>00299     <span class="comment">// radix 4 butterfly without twiddles</span>
<a name="l00300"></a>00300     scratch[0] = scratch_in_r[0] + scratch_in_r[3];
<a name="l00301"></a>00301     scratch[1] = scratch_in_r[0] - scratch_in_r[3];
<a name="l00302"></a>00302     scratch[2] = scratch_in_r[1] + scratch_in_r[1];
<a name="l00303"></a>00303     scratch[3] = scratch_in_r[2] + scratch_in_r[2];
<a name="l00304"></a>00304 
<a name="l00305"></a>00305     scratch_out_r[0] = scratch[0] + scratch[2];
<a name="l00306"></a>00306     scratch_out_r[1] = scratch[1] - scratch[3];
<a name="l00307"></a>00307     scratch_out_r[2] = scratch[0] - scratch[2];
<a name="l00308"></a>00308     scratch_out_r[3] = scratch[1] + scratch[3];
<a name="l00309"></a>00309 
<a name="l00310"></a>00310     <span class="comment">// NE10_PRINT_Q_VECTOR(scratch_out_r);</span>
<a name="l00311"></a>00311 
<a name="l00312"></a>00312     <span class="comment">// store</span>
<a name="l00313"></a>00313     Fout_r[0 * in_step] = scratch_out_r[0];
<a name="l00314"></a>00314     Fout_r[1 * in_step] = scratch_out_r[1];
<a name="l00315"></a>00315     Fout_r[2 * in_step] = scratch_out_r[2];
<a name="l00316"></a>00316     Fout_r[3 * in_step] = scratch_out_r[3];
<a name="l00317"></a>00317 
<a name="l00318"></a>00318 }
<a name="l00319"></a>00319 
<a name="l00320"></a>00320 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4_r2c_with_twiddles_other_butterfly_c (ne10_float32_t *Fout_r,
<a name="l00321"></a>00321         <span class="keyword">const</span> ne10_float32_t *Fin_r,
<a name="l00322"></a>00322         <span class="keyword">const</span> ne10_int32_t out_step,
<a name="l00323"></a>00323         <span class="keyword">const</span> ne10_int32_t in_step,
<a name="l00324"></a>00324         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles)
<a name="l00325"></a>00325 {
<a name="l00326"></a>00326     ne10_int32_t m_count;
<a name="l00327"></a>00327     ne10_float32_t *Fout_b = Fout_r + (((out_step&lt;&lt;1)-1)&lt;&lt;1) - 2; <span class="comment">// reversed</span>
<a name="l00328"></a>00328     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> scratch_tw[3], scratch_in[4];
<a name="l00329"></a>00329 
<a name="l00330"></a>00330     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> scratch[4], scratch_out[4];
<a name="l00331"></a>00331 
<a name="l00332"></a>00332     <span class="keywordflow">for</span> (m_count = (out_step &gt;&gt; 1) - 1; m_count; m_count --)
<a name="l00333"></a>00333     {
<a name="l00334"></a>00334         scratch_tw  [0] = twiddles[0 * out_step];
<a name="l00335"></a>00335         scratch_tw  [1] = twiddles[1 * out_step];
<a name="l00336"></a>00336         scratch_tw  [2] = twiddles[2 * out_step];
<a name="l00337"></a>00337 
<a name="l00338"></a>00338         scratch_in[0].r = Fin_r[0 * in_step    ];
<a name="l00339"></a>00339         scratch_in[0].i = Fin_r[0 * in_step + 1];
<a name="l00340"></a>00340         scratch_in[1].r = Fin_r[1 * in_step    ];
<a name="l00341"></a>00341         scratch_in[1].i = Fin_r[1 * in_step + 1];
<a name="l00342"></a>00342         scratch_in[2].r = Fin_r[2 * in_step    ];
<a name="l00343"></a>00343         scratch_in[2].i = Fin_r[2 * in_step + 1];
<a name="l00344"></a>00344         scratch_in[3].r = Fin_r[3 * in_step    ];
<a name="l00345"></a>00345         scratch_in[3].i = Fin_r[3 * in_step + 1];
<a name="l00346"></a>00346 
<a name="l00347"></a>00347         <span class="comment">// NE10_PRINT_Q2_VECTOR(scratch_in);</span>
<a name="l00348"></a>00348 
<a name="l00349"></a>00349         <span class="comment">// radix 4 butterfly with twiddles</span>
<a name="l00350"></a>00350         scratch[0].r = scratch_in[0].r;
<a name="l00351"></a>00351         scratch[0].i = scratch_in[0].i;
<a name="l00352"></a>00352         scratch[1].r = scratch_in[1].r * scratch_tw[0].r - scratch_in[1].i * scratch_tw[0].i;
<a name="l00353"></a>00353         scratch[1].i = scratch_in[1].i * scratch_tw[0].r + scratch_in[1].r * scratch_tw[0].i;
<a name="l00354"></a>00354 
<a name="l00355"></a>00355         scratch[2].r = scratch_in[2].r * scratch_tw[1].r - scratch_in[2].i * scratch_tw[1].i;
<a name="l00356"></a>00356         scratch[2].i = scratch_in[2].i * scratch_tw[1].r + scratch_in[2].r * scratch_tw[1].i;
<a name="l00357"></a>00357 
<a name="l00358"></a>00358         scratch[3].r = scratch_in[3].r * scratch_tw[2].r - scratch_in[3].i * scratch_tw[2].i;
<a name="l00359"></a>00359         scratch[3].i = scratch_in[3].i * scratch_tw[2].r + scratch_in[3].r * scratch_tw[2].i;
<a name="l00360"></a>00360 
<a name="l00361"></a>00361         NE10_FFT_R2C_CC_CC(scratch_out,scratch);
<a name="l00362"></a>00362 
<a name="l00363"></a>00363         <span class="comment">// NE10_PRINT_Q2_VECTOR(scratch_in);</span>
<a name="l00364"></a>00364 
<a name="l00365"></a>00365         <span class="comment">// result</span>
<a name="l00366"></a>00366         Fout_r[                    0] = scratch_out[0].r;
<a name="l00367"></a>00367         Fout_r[                    1] = scratch_out[0].i;
<a name="l00368"></a>00368         Fout_r[  (out_step &lt;&lt; 1)    ] = scratch_out[1].r;
<a name="l00369"></a>00369         Fout_r[  (out_step &lt;&lt; 1) + 1] = scratch_out[1].i;
<a name="l00370"></a>00370         Fout_b[                    0] = scratch_out[2].r;
<a name="l00371"></a>00371         Fout_b[                    1] = scratch_out[2].i;
<a name="l00372"></a>00372         Fout_b[- (out_step &lt;&lt; 1)    ] = scratch_out[3].r;
<a name="l00373"></a>00373         Fout_b[- (out_step &lt;&lt; 1) + 1] = scratch_out[3].i;
<a name="l00374"></a>00374 
<a name="l00375"></a>00375         <span class="comment">// update pointers</span>
<a name="l00376"></a>00376         Fin_r  += 2;
<a name="l00377"></a>00377         Fout_r += 2;
<a name="l00378"></a>00378         Fout_b -= 2;
<a name="l00379"></a>00379         twiddles ++;
<a name="l00380"></a>00380     }
<a name="l00381"></a>00381 }
<a name="l00382"></a>00382 
<a name="l00383"></a>00383 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4_c2r_with_twiddles_other_butterfly_c (ne10_float32_t *Fout_r,
<a name="l00384"></a>00384         <span class="keyword">const</span> ne10_float32_t *Fin_r,
<a name="l00385"></a>00385         <span class="keyword">const</span> ne10_int32_t out_step,
<a name="l00386"></a>00386         <span class="keyword">const</span> ne10_int32_t in_step,
<a name="l00387"></a>00387         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles)
<a name="l00388"></a>00388 {
<a name="l00389"></a>00389     ne10_int32_t m_count;
<a name="l00390"></a>00390     <span class="keyword">const</span> ne10_float32_t *Fin_b = Fin_r + (((out_step&lt;&lt;1)-1)&lt;&lt;1) - 2; <span class="comment">// reversed</span>
<a name="l00391"></a>00391     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> scratch_tw [3],
<a name="l00392"></a>00392                            scratch    [8],
<a name="l00393"></a>00393                            scratch_in [4],
<a name="l00394"></a>00394                            scratch_out[4];
<a name="l00395"></a>00395 
<a name="l00396"></a>00396     <span class="keywordflow">for</span> (m_count = (out_step &gt;&gt; 1) - 1; m_count; m_count --)
<a name="l00397"></a>00397     {
<a name="l00398"></a>00398         scratch_tw[0] = twiddles[0 * out_step];
<a name="l00399"></a>00399         scratch_tw[1] = twiddles[1 * out_step];
<a name="l00400"></a>00400         scratch_tw[2] = twiddles[2 * out_step];
<a name="l00401"></a>00401 
<a name="l00402"></a>00402         scratch_in[0].r = Fin_r[0];
<a name="l00403"></a>00403         scratch_in[0].i = Fin_r[1];
<a name="l00404"></a>00404 
<a name="l00405"></a>00405         scratch_in[1].r = Fin_b[0];
<a name="l00406"></a>00406         scratch_in[1].i = Fin_b[1];
<a name="l00407"></a>00407 
<a name="l00408"></a>00408         scratch_in[2].r = Fin_r[(out_step&lt;&lt;1) + 0];
<a name="l00409"></a>00409         scratch_in[2].i = Fin_r[(out_step&lt;&lt;1) + 1];
<a name="l00410"></a>00410 
<a name="l00411"></a>00411         scratch_in[3].r = Fin_b[-(out_step&lt;&lt;1) + 0];
<a name="l00412"></a>00412         scratch_in[3].i = Fin_b[-(out_step&lt;&lt;1) + 1];
<a name="l00413"></a>00413 
<a name="l00414"></a>00414         <span class="comment">// NE10_PRINT_Q2_VECTOR(scratch_in);</span>
<a name="l00415"></a>00415 
<a name="l00416"></a>00416         <span class="comment">// // inverse of &quot;result&quot;</span>
<a name="l00417"></a>00417         NE10_FFT_C2R_CC_CC(scratch,scratch_in);
<a name="l00418"></a>00418 
<a name="l00419"></a>00419         <span class="comment">// inverse of &quot;mutltipy twiddles&quot;</span>
<a name="l00420"></a>00420         scratch_out[0] = scratch[0];
<a name="l00421"></a>00421 
<a name="l00422"></a>00422         scratch_out[1].r = scratch[1].r * scratch_tw[0].r + scratch[1].i * scratch_tw[0].i;
<a name="l00423"></a>00423         scratch_out[1].i = scratch[1].i * scratch_tw[0].r - scratch[1].r * scratch_tw[0].i;
<a name="l00424"></a>00424 
<a name="l00425"></a>00425         scratch_out[2].r = scratch[2].r * scratch_tw[1].r + scratch[2].i * scratch_tw[1].i;
<a name="l00426"></a>00426         scratch_out[2].i = scratch[2].i * scratch_tw[1].r - scratch[2].r * scratch_tw[1].i;
<a name="l00427"></a>00427 
<a name="l00428"></a>00428         scratch_out[3].r = scratch[3].r * scratch_tw[2].r + scratch[3].i * scratch_tw[2].i;
<a name="l00429"></a>00429         scratch_out[3].i = scratch[3].i * scratch_tw[2].r - scratch[3].r * scratch_tw[2].i;
<a name="l00430"></a>00430 
<a name="l00431"></a>00431         <span class="comment">// NE10_PRINT_Q2_VECTOR(scratch_out);</span>
<a name="l00432"></a>00432 
<a name="l00433"></a>00433         <span class="comment">// store</span>
<a name="l00434"></a>00434         Fout_r[0 * in_step    ] = scratch_out[0].r;
<a name="l00435"></a>00435         Fout_r[0 * in_step + 1] = scratch_out[0].i;
<a name="l00436"></a>00436         Fout_r[1 * in_step    ] = scratch_out[1].r;
<a name="l00437"></a>00437         Fout_r[1 * in_step + 1] = scratch_out[1].i;
<a name="l00438"></a>00438         Fout_r[2 * in_step    ] = scratch_out[2].r;
<a name="l00439"></a>00439         Fout_r[2 * in_step + 1] = scratch_out[2].i;
<a name="l00440"></a>00440         Fout_r[3 * in_step    ] = scratch_out[3].r;
<a name="l00441"></a>00441         Fout_r[3 * in_step + 1] = scratch_out[3].i;
<a name="l00442"></a>00442 
<a name="l00443"></a>00443         <span class="comment">// update pointers</span>
<a name="l00444"></a>00444         Fin_r  += 2;
<a name="l00445"></a>00445         Fout_r += 2;
<a name="l00446"></a>00446         Fin_b -= 2;
<a name="l00447"></a>00447         twiddles ++;
<a name="l00448"></a>00448     }
<a name="l00449"></a>00449 }
<a name="l00450"></a>00450 
<a name="l00451"></a>00451 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4_r2c_with_twiddles_last_butterfly_c (ne10_float32_t *Fout_r,
<a name="l00452"></a>00452         <span class="keyword">const</span> ne10_float32_t *Fin_r,
<a name="l00453"></a>00453         <span class="keyword">const</span> ne10_int32_t out_step,
<a name="l00454"></a>00454         <span class="keyword">const</span> ne10_int32_t in_step,
<a name="l00455"></a>00455         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles)
<a name="l00456"></a>00456 {
<a name="l00457"></a>00457     ne10_float32_t scratch_in [4];
<a name="l00458"></a>00458     ne10_float32_t scratch_out[4];
<a name="l00459"></a>00459 
<a name="l00460"></a>00460     scratch_in[0] = Fin_r[0 * in_step];
<a name="l00461"></a>00461     scratch_in[1] = Fin_r[1 * in_step];
<a name="l00462"></a>00462     scratch_in[2] = Fin_r[2 * in_step];
<a name="l00463"></a>00463     scratch_in[3] = Fin_r[3 * in_step];
<a name="l00464"></a>00464 
<a name="l00465"></a>00465     <span class="comment">// NE10_PRINT_Q_VECTOR(scratch_in);</span>
<a name="l00466"></a>00466 
<a name="l00467"></a>00467     NE10_FFT_R2C_4R_CC(scratch_out,scratch_in);
<a name="l00468"></a>00468 
<a name="l00469"></a>00469     <span class="comment">// NE10_PRINT_Q_VECTOR(scratch_out);</span>
<a name="l00470"></a>00470 
<a name="l00471"></a>00471     Fout_r[                   0] = scratch_out[0];
<a name="l00472"></a>00472     Fout_r[                   1] = scratch_out[1];
<a name="l00473"></a>00473     Fout_r[ (out_step &lt;&lt; 1)    ] = scratch_out[2];
<a name="l00474"></a>00474     Fout_r[ (out_step &lt;&lt; 1) + 1] = scratch_out[3];
<a name="l00475"></a>00475 }
<a name="l00476"></a>00476 
<a name="l00477"></a>00477 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4_c2r_with_twiddles_last_butterfly_c (ne10_float32_t *Fout_r,
<a name="l00478"></a>00478         <span class="keyword">const</span> ne10_float32_t *Fin_r,
<a name="l00479"></a>00479         <span class="keyword">const</span> ne10_int32_t out_step,
<a name="l00480"></a>00480         <span class="keyword">const</span> ne10_int32_t in_step,
<a name="l00481"></a>00481         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles)
<a name="l00482"></a>00482 {
<a name="l00483"></a>00483     <span class="comment">// inverse operation of ne10_radix4_r2c_with_twiddles_last_butterfly_c</span>
<a name="l00484"></a>00484     ne10_float32_t scratch_in [4];
<a name="l00485"></a>00485     ne10_float32_t scratch_out[4];
<a name="l00486"></a>00486 
<a name="l00487"></a>00487     <span class="comment">// load</span>
<a name="l00488"></a>00488     scratch_in[0] = Fin_r[                   0];
<a name="l00489"></a>00489     scratch_in[1] = Fin_r[                   1];
<a name="l00490"></a>00490     scratch_in[2] = Fin_r[ (out_step &lt;&lt; 1)    ];
<a name="l00491"></a>00491     scratch_in[3] = Fin_r[ (out_step &lt;&lt; 1) + 1];
<a name="l00492"></a>00492 
<a name="l00493"></a>00493     <span class="comment">// NE10_PRINT_Q_VECTOR(scratch_in);</span>
<a name="l00494"></a>00494 
<a name="l00495"></a>00495     NE10_FFT_C2R_CC_4R(scratch_out,scratch_in);
<a name="l00496"></a>00496 
<a name="l00497"></a>00497     <span class="comment">// NE10_PRINT_Q_VECTOR(scratch_out);</span>
<a name="l00498"></a>00498 
<a name="l00499"></a>00499     <span class="comment">// store</span>
<a name="l00500"></a>00500     Fout_r[0 * in_step] = scratch_out[0];
<a name="l00501"></a>00501     Fout_r[1 * in_step] = scratch_out[1];
<a name="l00502"></a>00502     Fout_r[2 * in_step] = scratch_out[2];
<a name="l00503"></a>00503     Fout_r[3 * in_step] = scratch_out[3];
<a name="l00504"></a>00504 }
<a name="l00505"></a>00505 
<a name="l00506"></a>00506 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4_r2c_with_twiddles_c (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fout,
<a name="l00507"></a>00507         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fin,
<a name="l00508"></a>00508         <span class="keyword">const</span> ne10_int32_t fstride,
<a name="l00509"></a>00509         <span class="keyword">const</span> ne10_int32_t mstride,
<a name="l00510"></a>00510         <span class="keyword">const</span> ne10_int32_t nfft,
<a name="l00511"></a>00511         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles)
<a name="l00512"></a>00512 {
<a name="l00513"></a>00513     ne10_int32_t f_count;
<a name="l00514"></a>00514     <span class="keyword">const</span> ne10_int32_t in_step = nfft &gt;&gt; 2;
<a name="l00515"></a>00515     <span class="keyword">const</span> ne10_int32_t out_step = mstride;
<a name="l00516"></a>00516 
<a name="l00517"></a>00517     <span class="keyword">const</span> ne10_float32_t *Fin_r  = (ne10_float32_t*) Fin;
<a name="l00518"></a>00518     ne10_float32_t *Fout_r = (ne10_float32_t*) Fout;
<a name="l00519"></a>00519     <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *tw;
<a name="l00520"></a>00520 
<a name="l00521"></a>00521     Fout_r ++;
<a name="l00522"></a>00522     Fin_r ++;
<a name="l00523"></a>00523 
<a name="l00524"></a>00524     <span class="keywordflow">for</span> (f_count = fstride; f_count; f_count --)
<a name="l00525"></a>00525     {
<a name="l00526"></a>00526         tw = twiddles;
<a name="l00527"></a>00527 
<a name="l00528"></a>00528         <span class="comment">// first butterfly</span>
<a name="l00529"></a>00529         ne10_radix4_r2c_with_twiddles_first_butterfly_c (Fout_r, Fin_r, out_step, in_step, tw);
<a name="l00530"></a>00530 
<a name="l00531"></a>00531         tw ++;
<a name="l00532"></a>00532         Fin_r ++;
<a name="l00533"></a>00533         Fout_r ++;
<a name="l00534"></a>00534 
<a name="l00535"></a>00535         <span class="comment">// other butterfly</span>
<a name="l00536"></a>00536         ne10_radix4_r2c_with_twiddles_other_butterfly_c (Fout_r, Fin_r, out_step, in_step, tw);
<a name="l00537"></a>00537 
<a name="l00538"></a>00538         <span class="comment">// update Fin_r, Fout_r, twiddles</span>
<a name="l00539"></a>00539         tw     +=     ( (out_step &gt;&gt; 1) - 1);
<a name="l00540"></a>00540         Fin_r  += 2 * ( (out_step &gt;&gt; 1) - 1);
<a name="l00541"></a>00541         Fout_r += 2 * ( (out_step &gt;&gt; 1) - 1);
<a name="l00542"></a>00542 
<a name="l00543"></a>00543         <span class="comment">// last butterfly</span>
<a name="l00544"></a>00544         ne10_radix4_r2c_with_twiddles_last_butterfly_c (Fout_r, Fin_r, out_step, in_step, tw);
<a name="l00545"></a>00545         tw ++;
<a name="l00546"></a>00546         Fin_r ++;
<a name="l00547"></a>00547         Fout_r ++;
<a name="l00548"></a>00548 
<a name="l00549"></a>00549         Fout_r += 3 * out_step;
<a name="l00550"></a>00550     } <span class="comment">// f_count</span>
<a name="l00551"></a>00551 }
<a name="l00552"></a>00552 
<a name="l00553"></a>00553 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4_c2r_with_twiddles_c (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fout,
<a name="l00554"></a>00554         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fin,
<a name="l00555"></a>00555         <span class="keyword">const</span> ne10_int32_t fstride,
<a name="l00556"></a>00556         <span class="keyword">const</span> ne10_int32_t mstride,
<a name="l00557"></a>00557         <span class="keyword">const</span> ne10_int32_t nfft,
<a name="l00558"></a>00558         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles)
<a name="l00559"></a>00559 {
<a name="l00560"></a>00560     ne10_int32_t f_count;
<a name="l00561"></a>00561     <span class="keyword">const</span> ne10_int32_t in_step = nfft &gt;&gt; 2;
<a name="l00562"></a>00562     <span class="keyword">const</span> ne10_int32_t out_step = mstride;
<a name="l00563"></a>00563 
<a name="l00564"></a>00564     <span class="keyword">const</span> ne10_float32_t *Fin_r  = (ne10_float32_t*) Fin;
<a name="l00565"></a>00565           ne10_float32_t *Fout_r = (ne10_float32_t*) Fout;
<a name="l00566"></a>00566     <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *tw;
<a name="l00567"></a>00567 
<a name="l00568"></a>00568     <span class="keywordflow">for</span> (f_count = fstride; f_count; f_count --)
<a name="l00569"></a>00569     {
<a name="l00570"></a>00570         tw = twiddles;
<a name="l00571"></a>00571 
<a name="l00572"></a>00572         <span class="comment">// first butterfly</span>
<a name="l00573"></a>00573         ne10_radix4_c2r_with_twiddles_first_butterfly_c (Fout_r, Fin_r, out_step, in_step, tw);
<a name="l00574"></a>00574 
<a name="l00575"></a>00575         tw ++;
<a name="l00576"></a>00576         Fin_r  ++;
<a name="l00577"></a>00577         Fout_r ++;
<a name="l00578"></a>00578 
<a name="l00579"></a>00579         <span class="comment">// other butterfly</span>
<a name="l00580"></a>00580         ne10_radix4_c2r_with_twiddles_other_butterfly_c (Fout_r, Fin_r, out_step, in_step, tw);
<a name="l00581"></a>00581 
<a name="l00582"></a>00582         <span class="comment">// update Fin_r, Fout_r, twiddles</span>
<a name="l00583"></a>00583         tw     +=     ( (out_step &gt;&gt; 1) - 1);
<a name="l00584"></a>00584         Fin_r  += 2 * ( (out_step &gt;&gt; 1) - 1);
<a name="l00585"></a>00585         Fout_r += 2 * ( (out_step &gt;&gt; 1) - 1);
<a name="l00586"></a>00586 
<a name="l00587"></a>00587         <span class="comment">// last butterfly</span>
<a name="l00588"></a>00588         ne10_radix4_c2r_with_twiddles_last_butterfly_c (Fout_r, Fin_r, out_step, in_step, tw);
<a name="l00589"></a>00589         tw ++;
<a name="l00590"></a>00590         Fin_r  ++;
<a name="l00591"></a>00591         Fout_r ++;
<a name="l00592"></a>00592 
<a name="l00593"></a>00593         Fin_r += 3 * out_step;
<a name="l00594"></a>00594     } <span class="comment">// f_count</span>
<a name="l00595"></a>00595 }
<a name="l00596"></a>00596 
<a name="l00597"></a>00597 NE10_INLINE <span class="keywordtype">void</span> ne10_mixed_radix_r2c_butterfly_float32_c (
<a name="l00598"></a>00598     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * Fout,
<a name="l00599"></a>00599     <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * Fin,
<a name="l00600"></a>00600     <span class="keyword">const</span> ne10_int32_t * factors,
<a name="l00601"></a>00601     <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * twiddles,
<a name="l00602"></a>00602     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * buffer)
<a name="l00603"></a>00603 {
<a name="l00604"></a>00604     <span class="comment">// PRINT_POINTERS_INFO(Fin,Fout,buffer,twiddles);</span>
<a name="l00605"></a>00605 
<a name="l00606"></a>00606     ne10_int32_t fstride, mstride, nfft;
<a name="l00607"></a>00607     ne10_int32_t radix;
<a name="l00608"></a>00608     ne10_int32_t stage_count;
<a name="l00609"></a>00609 
<a name="l00610"></a>00610     <span class="comment">// init fstride, mstride, radix, nfft</span>
<a name="l00611"></a>00611     stage_count = factors[0];
<a name="l00612"></a>00612     fstride     = factors[1];
<a name="l00613"></a>00613     mstride     = factors[ (stage_count &lt;&lt; 1) - 1 ];
<a name="l00614"></a>00614     radix       = factors[  stage_count &lt;&lt; 1      ];
<a name="l00615"></a>00615     nfft        = radix * fstride;
<a name="l00616"></a>00616 
<a name="l00617"></a>00617     <span class="comment">// PRINT_STAGE_INFO;</span>
<a name="l00618"></a>00618 
<a name="l00619"></a>00619     <span class="keywordflow">if</span> (radix == 2)
<a name="l00620"></a>00620     {
<a name="l00621"></a>00621         <span class="comment">// combine one radix-4 and one radix-2 into one radix-8</span>
<a name="l00622"></a>00622         mstride &lt;&lt;= 2;
<a name="l00623"></a>00623         fstride &gt;&gt;= 2;
<a name="l00624"></a>00624         twiddles += 6; <span class="comment">// (4-1) x 2</span>
<a name="l00625"></a>00625         stage_count --;
<a name="l00626"></a>00626     }
<a name="l00627"></a>00627 
<a name="l00628"></a>00628     <span class="keywordflow">if</span> (stage_count % 2 == 0)
<a name="l00629"></a>00629     {
<a name="l00630"></a>00630         ne10_swap_ptr (buffer, Fout);
<a name="l00631"></a>00631     }
<a name="l00632"></a>00632 
<a name="l00633"></a>00633     <span class="comment">// the first stage</span>
<a name="l00634"></a>00634     <span class="keywordflow">if</span> (radix == 2)   <span class="comment">// length of FFT is 2^n (n is odd)</span>
<a name="l00635"></a>00635     {
<a name="l00636"></a>00636         <span class="comment">// PRINT_POINTERS_INFO(Fin,Fout,buffer,twiddles);</span>
<a name="l00637"></a>00637         ne10_radix8_r2c_c (Fout, Fin, fstride, mstride, nfft);
<a name="l00638"></a>00638     }
<a name="l00639"></a>00639     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (radix == 4)   <span class="comment">// length of FFT is 2^n (n is even)</span>
<a name="l00640"></a>00640     {
<a name="l00641"></a>00641         <span class="comment">// PRINT_POINTERS_INFO(Fin,Fout,buffer,twiddles);</span>
<a name="l00642"></a>00642         ne10_radix4_r2c_c (Fout, Fin, fstride, mstride, nfft);
<a name="l00643"></a>00643     }
<a name="l00644"></a>00644     <span class="comment">// end of first stage</span>
<a name="l00645"></a>00645 
<a name="l00646"></a>00646     <span class="comment">// others</span>
<a name="l00647"></a>00647     <span class="keywordflow">for</span> (; fstride &gt; 1;)
<a name="l00648"></a>00648     {
<a name="l00649"></a>00649         fstride &gt;&gt;= 2;
<a name="l00650"></a>00650         ne10_swap_ptr (buffer, Fout);
<a name="l00651"></a>00651 
<a name="l00652"></a>00652         <span class="comment">// PRINT_POINTERS_INFO(Fin,Fout,buffer,twiddles);</span>
<a name="l00653"></a>00653         ne10_radix4_r2c_with_twiddles_c (Fout, buffer, fstride, mstride, nfft, twiddles);
<a name="l00654"></a>00654         twiddles += 3 * mstride;
<a name="l00655"></a>00655         mstride &lt;&lt;= 2;
<a name="l00656"></a>00656 
<a name="l00657"></a>00657     } <span class="comment">// other stage</span>
<a name="l00658"></a>00658 }
<a name="l00659"></a>00659 
<a name="l00660"></a>00660 NE10_INLINE <span class="keywordtype">void</span> ne10_mixed_radix_c2r_butterfly_float32_c (
<a name="l00661"></a>00661     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * Fout,
<a name="l00662"></a>00662     <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * Fin,
<a name="l00663"></a>00663     <span class="keyword">const</span> ne10_int32_t * factors,
<a name="l00664"></a>00664     <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * twiddles,
<a name="l00665"></a>00665     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * buffer)
<a name="l00666"></a>00666 {
<a name="l00667"></a>00667     <span class="comment">// PRINT_POINTERS_INFO(Fin,Fout,buffer,twiddles);</span>
<a name="l00668"></a>00668 
<a name="l00669"></a>00669     ne10_int32_t fstride, mstride, nfft;
<a name="l00670"></a>00670     ne10_int32_t radix;
<a name="l00671"></a>00671     ne10_int32_t stage_count;
<a name="l00672"></a>00672 
<a name="l00673"></a>00673     <span class="comment">// init fstride, mstride, radix, nfft</span>
<a name="l00674"></a>00674     stage_count = factors[0];
<a name="l00675"></a>00675     fstride     = factors[1];
<a name="l00676"></a>00676     mstride     = factors[ (stage_count &lt;&lt; 1) - 1 ];
<a name="l00677"></a>00677     radix       = factors[  stage_count &lt;&lt; 1      ];
<a name="l00678"></a>00678     nfft        = radix * fstride;
<a name="l00679"></a>00679 
<a name="l00680"></a>00680     <span class="comment">// fstride, mstride for the last stage</span>
<a name="l00681"></a>00681     fstride = 1;
<a name="l00682"></a>00682     mstride = nfft &gt;&gt; 2;
<a name="l00683"></a>00683     <span class="comment">// PRINT_STAGE_INFO;</span>
<a name="l00684"></a>00684 
<a name="l00685"></a>00685     <span class="keywordflow">if</span> (radix == 2)
<a name="l00686"></a>00686     {
<a name="l00687"></a>00687         <span class="comment">// combine one radix-4 and one radix-2 into one radix-8</span>
<a name="l00688"></a>00688         stage_count --;
<a name="l00689"></a>00689     }
<a name="l00690"></a>00690 
<a name="l00691"></a>00691     <span class="keywordflow">if</span> (stage_count % 2 == 1)
<a name="l00692"></a>00692     {
<a name="l00693"></a>00693         ne10_swap_ptr (buffer, Fout);
<a name="l00694"></a>00694     }
<a name="l00695"></a>00695 
<a name="l00696"></a>00696     <span class="comment">// last butterfly -- inversed</span>
<a name="l00697"></a>00697     <span class="keywordflow">if</span> (stage_count &gt; 1)
<a name="l00698"></a>00698     {
<a name="l00699"></a>00699         twiddles -= 3 * mstride;
<a name="l00700"></a>00700         <span class="comment">// PRINT_STAGE_INFO;</span>
<a name="l00701"></a>00701         <span class="comment">// PRINT_POINTERS_INFO(Fin,Fout,buffer,twiddles);</span>
<a name="l00702"></a>00702         ne10_radix4_c2r_with_twiddles_c (buffer, Fin, fstride, mstride, nfft, twiddles);
<a name="l00703"></a>00703         fstride &lt;&lt;= 2;
<a name="l00704"></a>00704         mstride &gt;&gt;= 2;
<a name="l00705"></a>00705         stage_count --;
<a name="l00706"></a>00706     }
<a name="l00707"></a>00707 
<a name="l00708"></a>00708     <span class="comment">// others but the last stage</span>
<a name="l00709"></a>00709     <span class="keywordflow">for</span> (; stage_count &gt; 1;)
<a name="l00710"></a>00710     {
<a name="l00711"></a>00711         twiddles -= 3 * mstride;
<a name="l00712"></a>00712         <span class="comment">// PRINT_STAGE_INFO;</span>
<a name="l00713"></a>00713         <span class="comment">// PRINT_POINTERS_INFO(Fin,Fout,buffer,twiddles);</span>
<a name="l00714"></a>00714         ne10_radix4_c2r_with_twiddles_c (Fout, buffer, fstride, mstride, nfft, twiddles);
<a name="l00715"></a>00715         fstride &lt;&lt;= 2;
<a name="l00716"></a>00716         mstride &gt;&gt;= 2;
<a name="l00717"></a>00717         stage_count --;
<a name="l00718"></a>00718         ne10_swap_ptr (buffer, Fout);
<a name="l00719"></a>00719     } <span class="comment">// other stage</span>
<a name="l00720"></a>00720 
<a name="l00721"></a>00721     <span class="comment">// first stage -- inversed</span>
<a name="l00722"></a>00722     <span class="keywordflow">if</span> (radix == 2)   <span class="comment">// length of FFT is 2^n (n is odd)</span>
<a name="l00723"></a>00723     {
<a name="l00724"></a>00724         mstride &gt;&gt;= 1;
<a name="l00725"></a>00725 
<a name="l00726"></a>00726         <span class="comment">// PRINT_STAGE_INFO;</span>
<a name="l00727"></a>00727         <span class="comment">// PRINT_POINTERS_INFO(Fin,Fout,buffer,twiddles);</span>
<a name="l00728"></a>00728         ne10_radix8_c2r_c (Fout, buffer, fstride, mstride, nfft);
<a name="l00729"></a>00729     }
<a name="l00730"></a>00730     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (radix == 4)   <span class="comment">// length of FFT is 2^n (n is even)</span>
<a name="l00731"></a>00731     {
<a name="l00732"></a>00732         <span class="comment">// PRINT_STAGE_INFO;</span>
<a name="l00733"></a>00733         <span class="comment">// PRINT_POINTERS_INFO(Fin,Fout,buffer,twiddles);</span>
<a name="l00734"></a>00734         ne10_radix4_c2r_c (Fout, buffer, fstride, mstride, nfft);
<a name="l00735"></a>00735     }
<a name="l00736"></a>00736 }
<a name="l00737"></a>00737 
<a name="l00744"></a>00744 <a class="code" href="structne10__fft__r2c__state__float32__t.html">ne10_fft_r2c_cfg_float32_t</a> ne10_fft_alloc_r2c_float32 (ne10_int32_t nfft)
<a name="l00745"></a>00745 {
<a name="l00746"></a>00746     <a class="code" href="structne10__fft__r2c__state__float32__t.html">ne10_fft_r2c_cfg_float32_t</a> st = NULL;
<a name="l00747"></a>00747     ne10_int32_t ncfft = nfft &gt;&gt; 1;
<a name="l00748"></a>00748     ne10_int32_t result;
<a name="l00749"></a>00749 
<a name="l00750"></a>00750     ne10_uint32_t memneeded =   <span class="keyword">sizeof</span> (<a class="code" href="structne10__fft__r2c__state__float32__t.html">ne10_fft_r2c_state_float32_t</a>)
<a name="l00751"></a>00751                               + <span class="keyword">sizeof</span> (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>) * nfft              <span class="comment">/* buffer*/</span>
<a name="l00752"></a>00752                               + <span class="keyword">sizeof</span> (ne10_int32_t) * (NE10_MAXFACTORS * 2)       <span class="comment">/* r_factors */</span>
<a name="l00753"></a>00753                               + <span class="keyword">sizeof</span> (ne10_int32_t) * (NE10_MAXFACTORS * 2)       <span class="comment">/* r_factors_neon */</span>
<a name="l00754"></a>00754                               + <span class="keyword">sizeof</span> (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>) * nfft              <span class="comment">/* r_twiddles */</span>
<a name="l00755"></a>00755                               + <span class="keyword">sizeof</span> (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>) * nfft/4            <span class="comment">/* r_twiddles_neon */</span>
<a name="l00756"></a>00756                               + <span class="keyword">sizeof</span> (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>) * (12 + nfft/32*12) <span class="comment">/* r_super_twiddles_neon */</span>
<a name="l00757"></a>00757                               + NE10_FFT_BYTE_ALIGNMENT;     <span class="comment">/* 64-bit alignment*/</span>
<a name="l00758"></a>00758 
<a name="l00759"></a>00759     st = (<a class="code" href="structne10__fft__r2c__state__float32__t.html">ne10_fft_r2c_cfg_float32_t</a>) NE10_MALLOC (memneeded);
<a name="l00760"></a>00760 
<a name="l00761"></a>00761     <span class="keywordflow">if</span> (!st)
<a name="l00762"></a>00762     {
<a name="l00763"></a>00763         <span class="keywordflow">return</span> st;
<a name="l00764"></a>00764     }
<a name="l00765"></a>00765 
<a name="l00766"></a>00766     ne10_int32_t i,j;
<a name="l00767"></a>00767     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *tw;
<a name="l00768"></a>00768     <span class="keyword">const</span> ne10_float32_t pi = NE10_PI;
<a name="l00769"></a>00769     ne10_float32_t phase1;
<a name="l00770"></a>00770 
<a name="l00771"></a>00771     st-&gt;nfft = nfft;
<a name="l00772"></a>00772 
<a name="l00773"></a>00773     uintptr_t address = (uintptr_t) st + <span class="keyword">sizeof</span> (<a class="code" href="structne10__fft__r2c__state__float32__t.html">ne10_fft_r2c_state_float32_t</a>);
<a name="l00774"></a>00774     NE10_BYTE_ALIGNMENT (address, NE10_FFT_BYTE_ALIGNMENT);
<a name="l00775"></a>00775 
<a name="l00776"></a>00776     st-&gt;buffer = (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>*) address;
<a name="l00777"></a>00777     st-&gt;r_twiddles = st-&gt;buffer + nfft;
<a name="l00778"></a>00778     st-&gt;r_factors = (ne10_int32_t*) (st-&gt;r_twiddles + nfft);
<a name="l00779"></a>00779     st-&gt;r_twiddles_neon = (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>*) (st-&gt;r_factors + (NE10_MAXFACTORS * 2));
<a name="l00780"></a>00780     st-&gt;r_factors_neon = (ne10_int32_t*) (st-&gt;r_twiddles_neon + nfft/4);
<a name="l00781"></a>00781     st-&gt;r_super_twiddles_neon = (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>*) (st-&gt;r_factors_neon + (NE10_MAXFACTORS * 2));
<a name="l00782"></a>00782 
<a name="l00783"></a>00783     <span class="keywordflow">if</span> (nfft&lt;16)
<a name="l00784"></a>00784     {
<a name="l00785"></a>00785         <span class="keywordflow">return</span> st;
<a name="l00786"></a>00786     }
<a name="l00787"></a>00787 
<a name="l00788"></a>00788     <span class="comment">// factors and twiddles for rfft C</span>
<a name="l00789"></a>00789     ne10_factor (nfft, st-&gt;r_factors, NE10_FACTOR_DEFAULT);
<a name="l00790"></a>00790 
<a name="l00791"></a>00791     <span class="comment">// backward twiddles pointers</span>
<a name="l00792"></a>00792     st-&gt;r_twiddles_backward = ne10_fft_generate_twiddles_float32 (st-&gt;r_twiddles, st-&gt;r_factors, nfft);
<a name="l00793"></a>00793 
<a name="l00794"></a>00794     <span class="comment">// factors and twiddles for rfft neon</span>
<a name="l00795"></a>00795     result = ne10_factor (nfft/4, st-&gt;r_factors_neon, NE10_FACTOR_DEFAULT);
<a name="l00796"></a>00796     <span class="keywordflow">if</span> (result == NE10_ERR)
<a name="l00797"></a>00797     {
<a name="l00798"></a>00798         <span class="keywordflow">return</span> st;
<a name="l00799"></a>00799     }
<a name="l00800"></a>00800 
<a name="l00801"></a>00801     st-&gt;r_twiddles_neon_backward = ne10_fft_generate_twiddles_float32 (st-&gt;r_twiddles_neon, st-&gt;r_factors_neon, nfft/4);
<a name="l00802"></a>00802 
<a name="l00803"></a>00803     <span class="comment">// nfft/4 x 4</span>
<a name="l00804"></a>00804     tw = st-&gt;r_super_twiddles_neon;
<a name="l00805"></a>00805     <span class="keywordflow">for</span> (i = 1; i &lt; 4; i ++)
<a name="l00806"></a>00806     {
<a name="l00807"></a>00807         <span class="keywordflow">for</span> (j = 0; j &lt; 4; j++)
<a name="l00808"></a>00808         {
<a name="l00809"></a>00809             phase1 = - 2 * pi * ( (ne10_float32_t) (i * j) / nfft);
<a name="l00810"></a>00810             tw[4*i-4+j].r = (ne10_float32_t) cos (phase1);
<a name="l00811"></a>00811             tw[4*i-4+j].i = (ne10_float32_t) sin (phase1);
<a name="l00812"></a>00812         }
<a name="l00813"></a>00813     }
<a name="l00814"></a>00814 
<a name="l00815"></a>00815     ne10_int32_t k,s;
<a name="l00816"></a>00816     <span class="comment">// [nfft/32] x [3] x [4]</span>
<a name="l00817"></a>00817     <span class="comment">//     k        s     j</span>
<a name="l00818"></a>00818     <span class="keywordflow">for</span> (k=1; k&lt;nfft/32; k++)
<a name="l00819"></a>00819     {
<a name="l00820"></a>00820         <span class="comment">// transposed</span>
<a name="l00821"></a>00821         <span class="keywordflow">for</span> (s = 1; s &lt; 4; s++)
<a name="l00822"></a>00822         {
<a name="l00823"></a>00823             <span class="keywordflow">for</span> (j = 0; j &lt; 4; j++)
<a name="l00824"></a>00824             {
<a name="l00825"></a>00825                 phase1 = - 2 * pi * ( (ne10_float32_t) ((k*4+j) * s) / nfft);
<a name="l00826"></a>00826                 tw[12*k+j+4*(s-1)].r = (ne10_float32_t) cos (phase1);
<a name="l00827"></a>00827                 tw[12*k+j+4*(s-1)].i = (ne10_float32_t) sin (phase1);
<a name="l00828"></a>00828             }
<a name="l00829"></a>00829         }
<a name="l00830"></a>00830     }
<a name="l00831"></a>00831     return st;
<a name="l00832"></a>00832 }
<a name="l00833"></a>00833 
<a name="l00844"></a>00844 <span class="keywordtype">void</span> ne10_fft_r2c_1d_float32_c (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *fout,
<a name="l00845"></a>00845                                 ne10_float32_t *fin,
<a name="l00846"></a>00846                                 <a class="code" href="structne10__fft__r2c__state__float32__t.html">ne10_fft_r2c_cfg_float32_t</a> cfg)
<a name="l00847"></a>00847 {
<a name="l00848"></a>00848     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * tmpbuf = cfg-&gt;buffer;
<a name="l00849"></a>00849 
<a name="l00850"></a>00850     <span class="keywordflow">switch</span>(cfg-&gt;nfft)
<a name="l00851"></a>00851     {
<a name="l00852"></a>00852         <span class="keywordflow">case</span> 8:
<a name="l00853"></a>00853             ne10_radix8_r2c_c( (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>*) fout, ( <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>*) fin,1,1,8);
<a name="l00854"></a>00854             <span class="keywordflow">break</span>;
<a name="l00855"></a>00855         <span class="keywordflow">default</span>:
<a name="l00856"></a>00856             ne10_mixed_radix_r2c_butterfly_float32_c (
<a name="l00857"></a>00857                     fout,
<a name="l00858"></a>00858                     (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>*) fin,
<a name="l00859"></a>00859                     cfg-&gt;r_factors,
<a name="l00860"></a>00860                     cfg-&gt;r_twiddles,
<a name="l00861"></a>00861                     tmpbuf);
<a name="l00862"></a>00862             <span class="keywordflow">break</span>;
<a name="l00863"></a>00863     }
<a name="l00864"></a>00864 
<a name="l00865"></a>00865     fout[0].r = fout[0].i;
<a name="l00866"></a>00866     fout[0].i = 0.0f;
<a name="l00867"></a>00867     fout[(cfg-&gt;nfft) &gt;&gt; 1].i = 0.0f;
<a name="l00868"></a>00868 }
<a name="l00869"></a>00869 
<a name="l00880"></a>00880 <span class="keywordtype">void</span> ne10_fft_c2r_1d_float32_c (ne10_float32_t *fout,
<a name="l00881"></a>00881                                 <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *fin,
<a name="l00882"></a>00882                                 <a class="code" href="structne10__fft__r2c__state__float32__t.html">ne10_fft_r2c_cfg_float32_t</a> cfg)
<a name="l00883"></a>00883 {
<a name="l00884"></a>00884     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * tmpbuf = cfg-&gt;buffer;
<a name="l00885"></a>00885 
<a name="l00886"></a>00886     fin[0].i = fin[0].r;
<a name="l00887"></a>00887     fin[0].r = 0.0f;
<a name="l00888"></a>00888     <span class="keywordflow">switch</span>(cfg-&gt;nfft)
<a name="l00889"></a>00889     {
<a name="l00890"></a>00890         <span class="keywordflow">case</span> 8:
<a name="l00891"></a>00891             ne10_radix8_c2r_c( (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>*) fout, ( <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>*) &amp;fin[0].i,1,1,8);
<a name="l00892"></a>00892             <span class="keywordflow">break</span>;
<a name="l00893"></a>00893         <span class="keywordflow">default</span>:
<a name="l00894"></a>00894             ne10_mixed_radix_c2r_butterfly_float32_c (
<a name="l00895"></a>00895                     (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>*)fout,
<a name="l00896"></a>00896                     (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>*)&amp;fin[0].i, <span class="comment">// first real is moved to first image</span>
<a name="l00897"></a>00897                     cfg-&gt;r_factors,
<a name="l00898"></a>00898                     cfg-&gt;r_twiddles_backward,
<a name="l00899"></a>00899                     tmpbuf);
<a name="l00900"></a>00900             <span class="keywordflow">break</span>;
<a name="l00901"></a>00901     }
<a name="l00902"></a>00902     fin[0].r = fin[0].i;
<a name="l00903"></a>00903     fin[0].i = 0.0f;
<a name="l00904"></a>00904 }
<a name="l00905"></a>00905 
<a name="l00910"></a>00910 <span class="preprocessor">#endif // __aarch64__</span>
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Wed Jan 21 2015 18:47:14 for Project Ne10 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
