<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Project Ne10: /home/philwong/Ne10-gerrit/modules/dsp/NE10_fft_float32.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="ne10_logo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Project Ne10
   
   </div>
   <div id="projectbrief">An Open Optimized Software Library Project for the ARM Architecture</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">/home/philwong/Ne10-gerrit/modules/dsp/NE10_fft_float32.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> *  Copyright 2013-14 ARM Limited and Contributors.</span>
<a name="l00003"></a>00003 <span class="comment"> *  All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> *  Redistribution and use in source and binary forms, with or without</span>
<a name="l00006"></a>00006 <span class="comment"> *  modification, are permitted provided that the following conditions are met:</span>
<a name="l00007"></a>00007 <span class="comment"> *    * Redistributions of source code must retain the above copyright</span>
<a name="l00008"></a>00008 <span class="comment"> *      notice, this list of conditions and the following disclaimer.</span>
<a name="l00009"></a>00009 <span class="comment"> *    * Redistributions in binary form must reproduce the above copyright</span>
<a name="l00010"></a>00010 <span class="comment"> *      notice, this list of conditions and the following disclaimer in the</span>
<a name="l00011"></a>00011 <span class="comment"> *      documentation and/or other materials provided with the distribution.</span>
<a name="l00012"></a>00012 <span class="comment"> *    * Neither the name of ARM Limited nor the</span>
<a name="l00013"></a>00013 <span class="comment"> *      names of its contributors may be used to endorse or promote products</span>
<a name="l00014"></a>00014 <span class="comment"> *      derived from this software without specific prior written permission.</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> *  THIS SOFTWARE IS PROVIDED BY ARM LIMITED AND CONTRIBUTORS &quot;AS IS&quot; AND</span>
<a name="l00017"></a>00017 <span class="comment"> *  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED</span>
<a name="l00018"></a>00018 <span class="comment"> *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<a name="l00019"></a>00019 <span class="comment"> *  DISCLAIMED. IN NO EVENT SHALL ARM LIMITED AND CONTRIBUTORS BE LIABLE FOR ANY</span>
<a name="l00020"></a>00020 <span class="comment"> *  DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span>
<a name="l00021"></a>00021 <span class="comment"> *  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</span>
<a name="l00022"></a>00022 <span class="comment"> *  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND</span>
<a name="l00023"></a>00023 <span class="comment"> *  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00024"></a>00024 <span class="comment"> *  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS</span>
<a name="l00025"></a>00025 <span class="comment"> *  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00026"></a>00026 <span class="comment"> */</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="comment">/* license of Kiss FFT */</span>
<a name="l00029"></a>00029 <span class="comment">/*</span>
<a name="l00030"></a>00030 <span class="comment">Copyright (c) 2003-2010, Mark Borgerding</span>
<a name="l00031"></a>00031 <span class="comment"></span>
<a name="l00032"></a>00032 <span class="comment">All rights reserved.</span>
<a name="l00033"></a>00033 <span class="comment"></span>
<a name="l00034"></a>00034 <span class="comment">Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00035"></a>00035 <span class="comment"></span>
<a name="l00036"></a>00036 <span class="comment">    * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00037"></a>00037 <span class="comment">    * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00038"></a>00038 <span class="comment">    * Neither the author nor the names of any contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00039"></a>00039 <span class="comment"></span>
<a name="l00040"></a>00040 <span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00041"></a>00041 <span class="comment">*/</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="comment">/*</span>
<a name="l00044"></a>00044 <span class="comment"> * NE10 Library : dsp/NE10_fft_float32.c</span>
<a name="l00045"></a>00045 <span class="comment"> */</span>
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;NE10_types.h&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;NE10_macros.h&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;NE10_fft.h&quot;</span>
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 <span class="keyword">static</span> <span class="keywordtype">void</span> ne10_mixed_radix_butterfly_float32_c (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * Fout,
<a name="l00052"></a>00052         <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * Fin,
<a name="l00053"></a>00053         ne10_int32_t * factors,
<a name="l00054"></a>00054         <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * twiddles,
<a name="l00055"></a>00055         <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * buffer)
<a name="l00056"></a>00056 {
<a name="l00057"></a>00057     ne10_int32_t fstride, mstride, N;
<a name="l00058"></a>00058     ne10_int32_t fstride1;
<a name="l00059"></a>00059     ne10_int32_t f_count, m_count;
<a name="l00060"></a>00060     ne10_int32_t stage_count;
<a name="l00061"></a>00061 
<a name="l00062"></a>00062     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>   scratch_in[8];
<a name="l00063"></a>00063     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>   scratch_out[8];
<a name="l00064"></a>00064     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>   scratch[16];
<a name="l00065"></a>00065     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>   scratch_tw[6];
<a name="l00066"></a>00066 
<a name="l00067"></a>00067     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>   *Fin1, *Fin2, *Fout1, *Fout2;
<a name="l00068"></a>00068     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>   *Fout_ls = Fout;
<a name="l00069"></a>00069     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>   *Ftmp;
<a name="l00070"></a>00070     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>   *tw, *tw1, *tw2;
<a name="l00071"></a>00071     <span class="keyword">const</span> ne10_float32_t TW_81 = 0.70710678;
<a name="l00072"></a>00072     <span class="keyword">const</span> ne10_float32_t TW_81N = -0.70710678;
<a name="l00073"></a>00073 
<a name="l00074"></a>00074     <span class="comment">// init fstride, mstride, N</span>
<a name="l00075"></a>00075     stage_count = factors[0];
<a name="l00076"></a>00076     fstride = factors[1];
<a name="l00077"></a>00077     mstride = factors[ (stage_count &lt;&lt; 1) - 1 ];
<a name="l00078"></a>00078     N = factors[ stage_count &lt;&lt; 1 ]; <span class="comment">// radix</span>
<a name="l00079"></a>00079 
<a name="l00080"></a>00080     <span class="comment">// the first stage</span>
<a name="l00081"></a>00081     Fin1 = Fin;
<a name="l00082"></a>00082     Fout1 = Fout;
<a name="l00083"></a>00083     <span class="keywordflow">if</span> (N == 2)   <span class="comment">// length of FFT is 2^n (n is odd)</span>
<a name="l00084"></a>00084     {
<a name="l00085"></a>00085         <span class="comment">// radix 8</span>
<a name="l00086"></a>00086         N = fstride &gt;&gt; 1; <span class="comment">// 1/4 of length of FFT</span>
<a name="l00087"></a>00087         tw = twiddles;
<a name="l00088"></a>00088         fstride1 = fstride &gt;&gt; 2;
<a name="l00089"></a>00089 
<a name="l00090"></a>00090         Fin1 = Fin;
<a name="l00091"></a>00091         <span class="keywordflow">for</span> (f_count = 0; f_count &lt; fstride1; f_count ++)
<a name="l00092"></a>00092         {
<a name="l00093"></a>00093             Fout1 = &amp; Fout[ f_count * 8 ];
<a name="l00094"></a>00094 
<a name="l00095"></a>00095             scratch_in[0].r = Fin1[0].r + Fin1[0 + fstride].r;
<a name="l00096"></a>00096             scratch_in[0].i = Fin1[0].i + Fin1[0 + fstride].i;
<a name="l00097"></a>00097             scratch_in[1].r = Fin1[0].r - Fin1[0 + fstride].r;
<a name="l00098"></a>00098             scratch_in[1].i = Fin1[0].i - Fin1[0 + fstride].i;
<a name="l00099"></a>00099             scratch_in[2].r = Fin1[fstride1].r + Fin1[fstride1 + fstride].r;
<a name="l00100"></a>00100             scratch_in[2].i = Fin1[fstride1].i + Fin1[fstride1 + fstride].i;
<a name="l00101"></a>00101             scratch_in[3].r = Fin1[fstride1].r - Fin1[fstride1 + fstride].r;
<a name="l00102"></a>00102             scratch_in[3].i = Fin1[fstride1].i - Fin1[fstride1 + fstride].i;
<a name="l00103"></a>00103             scratch_in[4].r = Fin1[fstride1 * 2].r + Fin1[fstride1 * 2 + fstride].r;
<a name="l00104"></a>00104             scratch_in[4].i = Fin1[fstride1 * 2].i + Fin1[fstride1 * 2 + fstride].i;
<a name="l00105"></a>00105             scratch_in[5].r = Fin1[fstride1 * 2].r - Fin1[fstride1 * 2 + fstride].r;
<a name="l00106"></a>00106             scratch_in[5].i = Fin1[fstride1 * 2].i - Fin1[fstride1 * 2 + fstride].i;
<a name="l00107"></a>00107             scratch_in[6].r = Fin1[fstride1 * 3].r + Fin1[fstride1 * 3 + fstride].r;
<a name="l00108"></a>00108             scratch_in[6].i = Fin1[fstride1 * 3].i + Fin1[fstride1 * 3 + fstride].i;
<a name="l00109"></a>00109             scratch_in[7].r = Fin1[fstride1 * 3].r - Fin1[fstride1 * 3 + fstride].r;
<a name="l00110"></a>00110             scratch_in[7].i = Fin1[fstride1 * 3].i - Fin1[fstride1 * 3 + fstride].i;
<a name="l00111"></a>00111 
<a name="l00112"></a>00112             <span class="comment">// radix 4 butterfly without twiddles</span>
<a name="l00113"></a>00113             scratch[0] = scratch_in[0];
<a name="l00114"></a>00114             scratch[1] = scratch_in[1];
<a name="l00115"></a>00115 
<a name="l00116"></a>00116             scratch[2] = scratch_in[2];
<a name="l00117"></a>00117             scratch[3].r = (scratch_in[3].r + scratch_in[3].i) * TW_81;
<a name="l00118"></a>00118             scratch[3].i = (scratch_in[3].i - scratch_in[3].r) * TW_81;
<a name="l00119"></a>00119 
<a name="l00120"></a>00120             scratch[4] = scratch_in[4];
<a name="l00121"></a>00121             scratch[5].r = scratch_in[5].i;
<a name="l00122"></a>00122             scratch[5].i = -scratch_in[5].r;
<a name="l00123"></a>00123 
<a name="l00124"></a>00124             scratch[6].r = scratch_in[6].r;
<a name="l00125"></a>00125             scratch[6].i = scratch_in[6].i;
<a name="l00126"></a>00126             scratch[7].r = (scratch_in[7].r - scratch_in[7].i) * TW_81N;
<a name="l00127"></a>00127             scratch[7].i = (scratch_in[7].i + scratch_in[7].r) * TW_81N;
<a name="l00128"></a>00128 
<a name="l00129"></a>00129             <span class="comment">// radix 2 butterfly</span>
<a name="l00130"></a>00130             scratch[8].r = scratch[0].r + scratch[4].r;
<a name="l00131"></a>00131             scratch[8].i = scratch[0].i + scratch[4].i;
<a name="l00132"></a>00132             scratch[9].r = scratch[1].r + scratch[5].r;
<a name="l00133"></a>00133             scratch[9].i = scratch[1].i + scratch[5].i;
<a name="l00134"></a>00134 
<a name="l00135"></a>00135             scratch[10].r = scratch[0].r - scratch[4].r;
<a name="l00136"></a>00136             scratch[10].i = scratch[0].i - scratch[4].i;
<a name="l00137"></a>00137             scratch[11].r = scratch[1].r - scratch[5].r;
<a name="l00138"></a>00138             scratch[11].i = scratch[1].i - scratch[5].i;
<a name="l00139"></a>00139 
<a name="l00140"></a>00140             <span class="comment">// radix 2 butterfly</span>
<a name="l00141"></a>00141             scratch[12].r = scratch[2].r + scratch[6].r;
<a name="l00142"></a>00142             scratch[12].i = scratch[2].i + scratch[6].i;
<a name="l00143"></a>00143             scratch[13].r = scratch[3].r + scratch[7].r;
<a name="l00144"></a>00144             scratch[13].i = scratch[3].i + scratch[7].i;
<a name="l00145"></a>00145 
<a name="l00146"></a>00146             scratch[14].r = scratch[2].r - scratch[6].r;
<a name="l00147"></a>00147             scratch[14].i = scratch[2].i - scratch[6].i;
<a name="l00148"></a>00148             scratch[15].r = scratch[3].r - scratch[7].r;
<a name="l00149"></a>00149             scratch[15].i = scratch[3].i - scratch[7].i;
<a name="l00150"></a>00150 
<a name="l00151"></a>00151             <span class="comment">// third result</span>
<a name="l00152"></a>00152             scratch_out[4].r = scratch[8].r - scratch[12].r;
<a name="l00153"></a>00153             scratch_out[4].i = scratch[8].i - scratch[12].i;
<a name="l00154"></a>00154             scratch_out[5].r = scratch[9].r - scratch[13].r;
<a name="l00155"></a>00155             scratch_out[5].i = scratch[9].i - scratch[13].i;
<a name="l00156"></a>00156 
<a name="l00157"></a>00157             <span class="comment">// first result</span>
<a name="l00158"></a>00158             scratch_out[0].r = scratch[8].r + scratch[12].r;
<a name="l00159"></a>00159             scratch_out[0].i = scratch[8].i + scratch[12].i;
<a name="l00160"></a>00160             scratch_out[1].r = scratch[9].r + scratch[13].r;
<a name="l00161"></a>00161             scratch_out[1].i = scratch[9].i + scratch[13].i;
<a name="l00162"></a>00162 
<a name="l00163"></a>00163             <span class="comment">// second result</span>
<a name="l00164"></a>00164             scratch_out[2].r = scratch[10].r + scratch[14].i;
<a name="l00165"></a>00165             scratch_out[2].i = scratch[10].i - scratch[14].r;
<a name="l00166"></a>00166             scratch_out[3].r = scratch[11].r + scratch[15].i;
<a name="l00167"></a>00167             scratch_out[3].i = scratch[11].i - scratch[15].r;
<a name="l00168"></a>00168 
<a name="l00169"></a>00169             <span class="comment">// forth result</span>
<a name="l00170"></a>00170             scratch_out[6].r = scratch[10].r - scratch[14].i;
<a name="l00171"></a>00171             scratch_out[6].i = scratch[10].i + scratch[14].r;
<a name="l00172"></a>00172             scratch_out[7].r = scratch[11].r - scratch[15].i;
<a name="l00173"></a>00173             scratch_out[7].i = scratch[11].i + scratch[15].r;
<a name="l00174"></a>00174 
<a name="l00175"></a>00175             <span class="comment">// store</span>
<a name="l00176"></a>00176             Fout1[0] = scratch_out[0];
<a name="l00177"></a>00177             Fout1[1] = scratch_out[1];
<a name="l00178"></a>00178             Fout1[2] = scratch_out[2];
<a name="l00179"></a>00179             Fout1[3] = scratch_out[3];
<a name="l00180"></a>00180             Fout1[4] = scratch_out[4];
<a name="l00181"></a>00181             Fout1[5] = scratch_out[5];
<a name="l00182"></a>00182             Fout1[6] = scratch_out[6];
<a name="l00183"></a>00183             Fout1[7] = scratch_out[7];
<a name="l00184"></a>00184 
<a name="l00185"></a>00185             Fin1 += 1;
<a name="l00186"></a>00186         } <span class="comment">// f_count</span>
<a name="l00187"></a>00187         tw += 6;
<a name="l00188"></a>00188         mstride &lt;&lt;= 2;
<a name="l00189"></a>00189         fstride &gt;&gt;= 4;
<a name="l00190"></a>00190         stage_count -= 2;
<a name="l00191"></a>00191 
<a name="l00192"></a>00192         <span class="comment">// swap</span>
<a name="l00193"></a>00193         Ftmp = buffer;
<a name="l00194"></a>00194         buffer = Fout;
<a name="l00195"></a>00195         Fout = Ftmp;
<a name="l00196"></a>00196     }
<a name="l00197"></a>00197     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N == 4)   <span class="comment">// length of FFT is 2^n (n is even)</span>
<a name="l00198"></a>00198     {
<a name="l00199"></a>00199         <span class="comment">//fstride is nfft&gt;&gt;2</span>
<a name="l00200"></a>00200         <span class="keywordflow">for</span> (f_count = fstride; f_count ; f_count --)
<a name="l00201"></a>00201         {
<a name="l00202"></a>00202             <span class="comment">// load</span>
<a name="l00203"></a>00203             scratch_in[0] = *Fin1;
<a name="l00204"></a>00204             Fin2 = Fin1 + fstride;
<a name="l00205"></a>00205             scratch_in[1] = *Fin2;
<a name="l00206"></a>00206             Fin2 = Fin2 + fstride;
<a name="l00207"></a>00207             scratch_in[2] = *Fin2;
<a name="l00208"></a>00208             Fin2 = Fin2 + fstride;
<a name="l00209"></a>00209             scratch_in[3] = *Fin2;
<a name="l00210"></a>00210 
<a name="l00211"></a>00211             <span class="comment">// radix 4 butterfly without twiddles</span>
<a name="l00212"></a>00212 
<a name="l00213"></a>00213             <span class="comment">// radix 2 butterfly</span>
<a name="l00214"></a>00214             scratch[0].r = scratch_in[0].r + scratch_in[2].r;
<a name="l00215"></a>00215             scratch[0].i = scratch_in[0].i + scratch_in[2].i;
<a name="l00216"></a>00216 
<a name="l00217"></a>00217             scratch[1].r = scratch_in[0].r - scratch_in[2].r;
<a name="l00218"></a>00218             scratch[1].i = scratch_in[0].i - scratch_in[2].i;
<a name="l00219"></a>00219 
<a name="l00220"></a>00220             <span class="comment">// radix 2 butterfly</span>
<a name="l00221"></a>00221             scratch[2].r = scratch_in[1].r + scratch_in[3].r;
<a name="l00222"></a>00222             scratch[2].i = scratch_in[1].i + scratch_in[3].i;
<a name="l00223"></a>00223 
<a name="l00224"></a>00224             scratch[3].r = scratch_in[1].r - scratch_in[3].r;
<a name="l00225"></a>00225             scratch[3].i = scratch_in[1].i - scratch_in[3].i;
<a name="l00226"></a>00226 
<a name="l00227"></a>00227             <span class="comment">// third result</span>
<a name="l00228"></a>00228             scratch_out[2].r = scratch[0].r - scratch[2].r;
<a name="l00229"></a>00229             scratch_out[2].i = scratch[0].i - scratch[2].i;
<a name="l00230"></a>00230 
<a name="l00231"></a>00231             <span class="comment">// first result</span>
<a name="l00232"></a>00232             scratch_out[0].r = scratch[0].r + scratch[2].r;
<a name="l00233"></a>00233             scratch_out[0].i = scratch[0].i + scratch[2].i;
<a name="l00234"></a>00234 
<a name="l00235"></a>00235             <span class="comment">// second result</span>
<a name="l00236"></a>00236             scratch_out[1].r = scratch[1].r + scratch[3].i;
<a name="l00237"></a>00237             scratch_out[1].i = scratch[1].i - scratch[3].r;
<a name="l00238"></a>00238 
<a name="l00239"></a>00239             <span class="comment">// forth result</span>
<a name="l00240"></a>00240             scratch_out[3].r = scratch[1].r - scratch[3].i;
<a name="l00241"></a>00241             scratch_out[3].i = scratch[1].i + scratch[3].r;
<a name="l00242"></a>00242 
<a name="l00243"></a>00243             <span class="comment">// store</span>
<a name="l00244"></a>00244             * Fout1 ++ = scratch_out[0];
<a name="l00245"></a>00245             * Fout1 ++ = scratch_out[1];
<a name="l00246"></a>00246             * Fout1 ++ = scratch_out[2];
<a name="l00247"></a>00247             * Fout1 ++ = scratch_out[3];
<a name="l00248"></a>00248 
<a name="l00249"></a>00249             Fin1++;
<a name="l00250"></a>00250         } <span class="comment">// f_count</span>
<a name="l00251"></a>00251 
<a name="l00252"></a>00252         N = fstride; <span class="comment">// 1/4 of length of FFT</span>
<a name="l00253"></a>00253 
<a name="l00254"></a>00254         <span class="comment">// update address for other stages</span>
<a name="l00255"></a>00255         stage_count--;
<a name="l00256"></a>00256         tw = twiddles;
<a name="l00257"></a>00257         fstride &gt;&gt;= 2;
<a name="l00258"></a>00258 
<a name="l00259"></a>00259         <span class="comment">// swap</span>
<a name="l00260"></a>00260         Ftmp = buffer;
<a name="l00261"></a>00261         buffer = Fout;
<a name="l00262"></a>00262         Fout = Ftmp;
<a name="l00263"></a>00263         <span class="comment">// end of first stage</span>
<a name="l00264"></a>00264     }
<a name="l00265"></a>00265 
<a name="l00266"></a>00266 
<a name="l00267"></a>00267     <span class="comment">// others but the last one</span>
<a name="l00268"></a>00268     <span class="keywordflow">for</span> (; stage_count &gt; 1 ; stage_count--)
<a name="l00269"></a>00269     {
<a name="l00270"></a>00270         Fin1 = buffer;
<a name="l00271"></a>00271         <span class="keywordflow">for</span> (f_count = 0; f_count &lt; fstride; f_count ++)
<a name="l00272"></a>00272         {
<a name="l00273"></a>00273             Fout1 = &amp; Fout[ f_count * mstride &lt;&lt; 2 ];
<a name="l00274"></a>00274             tw1 = tw;
<a name="l00275"></a>00275             <span class="keywordflow">for</span> (m_count = mstride; m_count ; m_count --)
<a name="l00276"></a>00276             {
<a name="l00277"></a>00277                 <span class="comment">// load</span>
<a name="l00278"></a>00278                 scratch_tw[0] = *tw1;
<a name="l00279"></a>00279                 tw2 = tw1 + mstride;
<a name="l00280"></a>00280                 scratch_tw[1] = *tw2;
<a name="l00281"></a>00281                 tw2 += mstride;
<a name="l00282"></a>00282                 scratch_tw[2] = *tw2;
<a name="l00283"></a>00283                 scratch_in[0] = * Fin1;
<a name="l00284"></a>00284                 Fin2 = Fin1 + N;
<a name="l00285"></a>00285                 scratch_in[1] = * Fin2;
<a name="l00286"></a>00286                 Fin2 += N;
<a name="l00287"></a>00287                 scratch_in[2] = * Fin2;
<a name="l00288"></a>00288                 Fin2 += N;
<a name="l00289"></a>00289                 scratch_in[3] = * Fin2;
<a name="l00290"></a>00290 
<a name="l00291"></a>00291                 <span class="comment">// radix 4 butterfly with twiddles</span>
<a name="l00292"></a>00292 
<a name="l00293"></a>00293                 scratch[0] = scratch_in[0];
<a name="l00294"></a>00294                 scratch[1].r = scratch_in[1].r * scratch_tw[0].r - scratch_in[1].i * scratch_tw[0].i;
<a name="l00295"></a>00295                 scratch[1].i = scratch_in[1].i * scratch_tw[0].r + scratch_in[1].r * scratch_tw[0].i;
<a name="l00296"></a>00296 
<a name="l00297"></a>00297                 scratch[2].r = scratch_in[2].r * scratch_tw[1].r - scratch_in[2].i * scratch_tw[1].i;
<a name="l00298"></a>00298                 scratch[2].i = scratch_in[2].i * scratch_tw[1].r + scratch_in[2].r * scratch_tw[1].i;
<a name="l00299"></a>00299 
<a name="l00300"></a>00300                 scratch[3].r = scratch_in[3].r * scratch_tw[2].r - scratch_in[3].i * scratch_tw[2].i;
<a name="l00301"></a>00301                 scratch[3].i = scratch_in[3].i * scratch_tw[2].r + scratch_in[3].r * scratch_tw[2].i;
<a name="l00302"></a>00302 
<a name="l00303"></a>00303                 <span class="comment">// radix 2 butterfly</span>
<a name="l00304"></a>00304                 scratch[4].r = scratch[0].r + scratch[2].r;
<a name="l00305"></a>00305                 scratch[4].i = scratch[0].i + scratch[2].i;
<a name="l00306"></a>00306 
<a name="l00307"></a>00307                 scratch[5].r = scratch[0].r - scratch[2].r;
<a name="l00308"></a>00308                 scratch[5].i = scratch[0].i - scratch[2].i;
<a name="l00309"></a>00309 
<a name="l00310"></a>00310                 <span class="comment">// radix 2 butterfly</span>
<a name="l00311"></a>00311                 scratch[6].r = scratch[1].r + scratch[3].r;
<a name="l00312"></a>00312                 scratch[6].i = scratch[1].i + scratch[3].i;
<a name="l00313"></a>00313 
<a name="l00314"></a>00314                 scratch[7].r = scratch[1].r - scratch[3].r;
<a name="l00315"></a>00315                 scratch[7].i = scratch[1].i - scratch[3].i;
<a name="l00316"></a>00316 
<a name="l00317"></a>00317                 <span class="comment">// third result</span>
<a name="l00318"></a>00318                 scratch_out[2].r = scratch[4].r - scratch[6].r;
<a name="l00319"></a>00319                 scratch_out[2].i = scratch[4].i - scratch[6].i;
<a name="l00320"></a>00320 
<a name="l00321"></a>00321                 <span class="comment">// first result</span>
<a name="l00322"></a>00322                 scratch_out[0].r = scratch[4].r + scratch[6].r;
<a name="l00323"></a>00323                 scratch_out[0].i = scratch[4].i + scratch[6].i;
<a name="l00324"></a>00324 
<a name="l00325"></a>00325                 <span class="comment">// second result</span>
<a name="l00326"></a>00326                 scratch_out[1].r = scratch[5].r + scratch[7].i;
<a name="l00327"></a>00327                 scratch_out[1].i = scratch[5].i - scratch[7].r;
<a name="l00328"></a>00328 
<a name="l00329"></a>00329                 <span class="comment">// forth result</span>
<a name="l00330"></a>00330                 scratch_out[3].r = scratch[5].r - scratch[7].i;
<a name="l00331"></a>00331                 scratch_out[3].i = scratch[5].i + scratch[7].r;
<a name="l00332"></a>00332 
<a name="l00333"></a>00333                 <span class="comment">// store</span>
<a name="l00334"></a>00334                 *Fout1 = scratch_out[0];
<a name="l00335"></a>00335                 Fout2 = Fout1 + mstride;
<a name="l00336"></a>00336                 *Fout2 = scratch_out[1];
<a name="l00337"></a>00337                 Fout2 += mstride;
<a name="l00338"></a>00338                 *Fout2 = scratch_out[2];
<a name="l00339"></a>00339                 Fout2 += mstride;
<a name="l00340"></a>00340                 *Fout2 = scratch_out[3];
<a name="l00341"></a>00341 
<a name="l00342"></a>00342                 tw1++;
<a name="l00343"></a>00343                 Fin1 ++;
<a name="l00344"></a>00344                 Fout1 ++;
<a name="l00345"></a>00345             } <span class="comment">// m_count</span>
<a name="l00346"></a>00346         } <span class="comment">// f_count</span>
<a name="l00347"></a>00347         tw += mstride * 3;
<a name="l00348"></a>00348         mstride &lt;&lt;= 2;
<a name="l00349"></a>00349         fstride &gt;&gt;= 2;
<a name="l00350"></a>00350 
<a name="l00351"></a>00351         <span class="comment">// swap</span>
<a name="l00352"></a>00352         Ftmp = buffer;
<a name="l00353"></a>00353         buffer = Fout;
<a name="l00354"></a>00354         Fout = Ftmp;
<a name="l00355"></a>00355     } <span class="comment">// stage_count</span>
<a name="l00356"></a>00356 
<a name="l00357"></a>00357     <span class="comment">// the last one</span>
<a name="l00358"></a>00358     <span class="keywordflow">if</span> (stage_count)
<a name="l00359"></a>00359     {
<a name="l00360"></a>00360         Fin1 = buffer;
<a name="l00361"></a>00361         <span class="comment">// if stage count is even, output to the input array</span>
<a name="l00362"></a>00362         Fout1 = Fout_ls;
<a name="l00363"></a>00363 
<a name="l00364"></a>00364         <span class="keywordflow">for</span> (f_count = 0; f_count &lt; fstride; f_count ++)
<a name="l00365"></a>00365         {
<a name="l00366"></a>00366             tw1 = tw;
<a name="l00367"></a>00367             <span class="keywordflow">for</span> (m_count = mstride; m_count ; m_count --)
<a name="l00368"></a>00368             {
<a name="l00369"></a>00369                 <span class="comment">// load</span>
<a name="l00370"></a>00370                 scratch_tw[0] = *tw1;
<a name="l00371"></a>00371                 tw2 = tw1 + mstride;
<a name="l00372"></a>00372                 scratch_tw[1] = *tw2;
<a name="l00373"></a>00373                 tw2 += mstride;
<a name="l00374"></a>00374                 scratch_tw[2] = *tw2;
<a name="l00375"></a>00375                 scratch_in[0] = * Fin1;
<a name="l00376"></a>00376                 Fin2 = Fin1 + N;
<a name="l00377"></a>00377                 scratch_in[1] = * Fin2;
<a name="l00378"></a>00378                 Fin2 += N;
<a name="l00379"></a>00379                 scratch_in[2] = * Fin2;
<a name="l00380"></a>00380                 Fin2 += N;
<a name="l00381"></a>00381                 scratch_in[3] = * Fin2;
<a name="l00382"></a>00382 
<a name="l00383"></a>00383                 <span class="comment">// radix 4 butterfly with twiddles</span>
<a name="l00384"></a>00384 
<a name="l00385"></a>00385                 scratch[0] = scratch_in[0];
<a name="l00386"></a>00386                 scratch[1].r = scratch_in[1].r * scratch_tw[0].r - scratch_in[1].i * scratch_tw[0].i;
<a name="l00387"></a>00387                 scratch[1].i = scratch_in[1].i * scratch_tw[0].r + scratch_in[1].r * scratch_tw[0].i;
<a name="l00388"></a>00388 
<a name="l00389"></a>00389                 scratch[2].r = scratch_in[2].r * scratch_tw[1].r - scratch_in[2].i * scratch_tw[1].i;
<a name="l00390"></a>00390                 scratch[2].i = scratch_in[2].i * scratch_tw[1].r + scratch_in[2].r * scratch_tw[1].i;
<a name="l00391"></a>00391 
<a name="l00392"></a>00392                 scratch[3].r = scratch_in[3].r * scratch_tw[2].r - scratch_in[3].i * scratch_tw[2].i;
<a name="l00393"></a>00393                 scratch[3].i = scratch_in[3].i * scratch_tw[2].r + scratch_in[3].r * scratch_tw[2].i;
<a name="l00394"></a>00394 
<a name="l00395"></a>00395                 <span class="comment">// radix 2 butterfly</span>
<a name="l00396"></a>00396                 scratch[4].r = scratch[0].r + scratch[2].r;
<a name="l00397"></a>00397                 scratch[4].i = scratch[0].i + scratch[2].i;
<a name="l00398"></a>00398 
<a name="l00399"></a>00399                 scratch[5].r = scratch[0].r - scratch[2].r;
<a name="l00400"></a>00400                 scratch[5].i = scratch[0].i - scratch[2].i;
<a name="l00401"></a>00401 
<a name="l00402"></a>00402                 <span class="comment">// radix 2 butterfly</span>
<a name="l00403"></a>00403                 scratch[6].r = scratch[1].r + scratch[3].r;
<a name="l00404"></a>00404                 scratch[6].i = scratch[1].i + scratch[3].i;
<a name="l00405"></a>00405 
<a name="l00406"></a>00406                 scratch[7].r = scratch[1].r - scratch[3].r;
<a name="l00407"></a>00407                 scratch[7].i = scratch[1].i - scratch[3].i;
<a name="l00408"></a>00408 
<a name="l00409"></a>00409                 <span class="comment">// third result</span>
<a name="l00410"></a>00410                 scratch_out[2].r = scratch[4].r - scratch[6].r;
<a name="l00411"></a>00411                 scratch_out[2].i = scratch[4].i - scratch[6].i;
<a name="l00412"></a>00412 
<a name="l00413"></a>00413                 <span class="comment">// first result</span>
<a name="l00414"></a>00414                 scratch_out[0].r = scratch[4].r + scratch[6].r;
<a name="l00415"></a>00415                 scratch_out[0].i = scratch[4].i + scratch[6].i;
<a name="l00416"></a>00416 
<a name="l00417"></a>00417                 <span class="comment">// second result</span>
<a name="l00418"></a>00418                 scratch_out[1].r = scratch[5].r + scratch[7].i;
<a name="l00419"></a>00419                 scratch_out[1].i = scratch[5].i - scratch[7].r;
<a name="l00420"></a>00420 
<a name="l00421"></a>00421                 <span class="comment">// forth result</span>
<a name="l00422"></a>00422                 scratch_out[3].r = scratch[5].r - scratch[7].i;
<a name="l00423"></a>00423                 scratch_out[3].i = scratch[5].i + scratch[7].r;
<a name="l00424"></a>00424 
<a name="l00425"></a>00425                 <span class="comment">// store</span>
<a name="l00426"></a>00426                 *Fout1 = scratch_out[0];
<a name="l00427"></a>00427                 Fout2 = Fout1 + N;
<a name="l00428"></a>00428                 *Fout2 = scratch_out[1];
<a name="l00429"></a>00429                 Fout2 += N;
<a name="l00430"></a>00430                 *Fout2 = scratch_out[2];
<a name="l00431"></a>00431                 Fout2 += N;
<a name="l00432"></a>00432                 *Fout2 = scratch_out[3];
<a name="l00433"></a>00433 
<a name="l00434"></a>00434                 tw1 ++;
<a name="l00435"></a>00435                 Fin1 ++;
<a name="l00436"></a>00436                 Fout1 ++;
<a name="l00437"></a>00437             } <span class="comment">// m_count</span>
<a name="l00438"></a>00438         } <span class="comment">// f_count</span>
<a name="l00439"></a>00439     } <span class="comment">// last stage</span>
<a name="l00440"></a>00440 }
<a name="l00441"></a>00441 
<a name="l00442"></a>00442 <span class="keyword">static</span> <span class="keywordtype">void</span> ne10_mixed_radix_butterfly_inverse_float32_c (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * Fout,
<a name="l00443"></a>00443         <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * Fin,
<a name="l00444"></a>00444         ne10_int32_t * factors,
<a name="l00445"></a>00445         <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * twiddles,
<a name="l00446"></a>00446         <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * buffer)
<a name="l00447"></a>00447 {
<a name="l00448"></a>00448     ne10_int32_t fstride, mstride, N;
<a name="l00449"></a>00449     ne10_int32_t fstride1;
<a name="l00450"></a>00450     ne10_int32_t f_count, m_count;
<a name="l00451"></a>00451     ne10_int32_t stage_count;
<a name="l00452"></a>00452     ne10_float32_t one_by_nfft;
<a name="l00453"></a>00453 
<a name="l00454"></a>00454     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>   scratch_in[8];
<a name="l00455"></a>00455     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>   scratch_out[8];
<a name="l00456"></a>00456     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>   scratch[16];
<a name="l00457"></a>00457     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>   scratch_tw[6];
<a name="l00458"></a>00458 
<a name="l00459"></a>00459     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>   *Fin1, *Fin2, *Fout1, *Fout2;
<a name="l00460"></a>00460     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>   *Fout_ls = Fout;
<a name="l00461"></a>00461     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>   *Ftmp;
<a name="l00462"></a>00462     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>   *tw, *tw1, *tw2;
<a name="l00463"></a>00463     <span class="keyword">const</span> ne10_float32_t TW_81 = 0.70710678;
<a name="l00464"></a>00464     <span class="keyword">const</span> ne10_float32_t TW_81N = -0.70710678;
<a name="l00465"></a>00465 
<a name="l00466"></a>00466     <span class="comment">// init fstride, mstride, N</span>
<a name="l00467"></a>00467     stage_count = factors[0];
<a name="l00468"></a>00468     fstride = factors[1];
<a name="l00469"></a>00469     mstride = factors[ (stage_count &lt;&lt; 1) - 1 ];
<a name="l00470"></a>00470     N = factors[ stage_count &lt;&lt; 1 ]; <span class="comment">// radix</span>
<a name="l00471"></a>00471     one_by_nfft = (1.0f / (ne10_float32_t) (fstride * N));
<a name="l00472"></a>00472 
<a name="l00473"></a>00473     <span class="comment">// the first stage</span>
<a name="l00474"></a>00474     Fin1 = Fin;
<a name="l00475"></a>00475     Fout1 = Fout;
<a name="l00476"></a>00476     <span class="keywordflow">if</span> (N == 2)   <span class="comment">// length of FFT is 2^n (n is odd)</span>
<a name="l00477"></a>00477     {
<a name="l00478"></a>00478         <span class="comment">// radix 8</span>
<a name="l00479"></a>00479         N = fstride &gt;&gt; 1; <span class="comment">// 1/4 of length of FFT</span>
<a name="l00480"></a>00480         tw = twiddles;
<a name="l00481"></a>00481         fstride1 = fstride &gt;&gt; 2;
<a name="l00482"></a>00482 
<a name="l00483"></a>00483         Fin1 = Fin;
<a name="l00484"></a>00484         <span class="keywordflow">for</span> (f_count = 0; f_count &lt; fstride1; f_count ++)
<a name="l00485"></a>00485         {
<a name="l00486"></a>00486             Fout1 = &amp; Fout[ f_count * 8 ];
<a name="l00487"></a>00487 
<a name="l00488"></a>00488             scratch_in[0].r = Fin1[0].r + Fin1[0 + fstride].r;
<a name="l00489"></a>00489             scratch_in[0].i = Fin1[0].i + Fin1[0 + fstride].i;
<a name="l00490"></a>00490             scratch_in[1].r = Fin1[0].r - Fin1[0 + fstride].r;
<a name="l00491"></a>00491             scratch_in[1].i = Fin1[0].i - Fin1[0 + fstride].i;
<a name="l00492"></a>00492             scratch_in[2].r = Fin1[fstride1].r + Fin1[fstride1 + fstride].r;
<a name="l00493"></a>00493             scratch_in[2].i = Fin1[fstride1].i + Fin1[fstride1 + fstride].i;
<a name="l00494"></a>00494             scratch_in[3].r = Fin1[fstride1].r - Fin1[fstride1 + fstride].r;
<a name="l00495"></a>00495             scratch_in[3].i = Fin1[fstride1].i - Fin1[fstride1 + fstride].i;
<a name="l00496"></a>00496             scratch_in[4].r = Fin1[fstride1 * 2].r + Fin1[fstride1 * 2 + fstride].r;
<a name="l00497"></a>00497             scratch_in[4].i = Fin1[fstride1 * 2].i + Fin1[fstride1 * 2 + fstride].i;
<a name="l00498"></a>00498             scratch_in[5].r = Fin1[fstride1 * 2].r - Fin1[fstride1 * 2 + fstride].r;
<a name="l00499"></a>00499             scratch_in[5].i = Fin1[fstride1 * 2].i - Fin1[fstride1 * 2 + fstride].i;
<a name="l00500"></a>00500             scratch_in[6].r = Fin1[fstride1 * 3].r + Fin1[fstride1 * 3 + fstride].r;
<a name="l00501"></a>00501             scratch_in[6].i = Fin1[fstride1 * 3].i + Fin1[fstride1 * 3 + fstride].i;
<a name="l00502"></a>00502             scratch_in[7].r = Fin1[fstride1 * 3].r - Fin1[fstride1 * 3 + fstride].r;
<a name="l00503"></a>00503             scratch_in[7].i = Fin1[fstride1 * 3].i - Fin1[fstride1 * 3 + fstride].i;
<a name="l00504"></a>00504 
<a name="l00505"></a>00505             <span class="comment">// radix 4 butterfly with twiddles</span>
<a name="l00506"></a>00506 
<a name="l00507"></a>00507             scratch[0] = scratch_in[0];
<a name="l00508"></a>00508             scratch[1] = scratch_in[1];
<a name="l00509"></a>00509 
<a name="l00510"></a>00510             scratch[2] = scratch_in[2];
<a name="l00511"></a>00511             scratch[3].r = (scratch_in[3].r - scratch_in[3].i) * TW_81;
<a name="l00512"></a>00512             scratch[3].i = (scratch_in[3].i + scratch_in[3].r) * TW_81;
<a name="l00513"></a>00513 
<a name="l00514"></a>00514             scratch[4] = scratch_in[4];
<a name="l00515"></a>00515             scratch[5].r = -scratch_in[5].i;
<a name="l00516"></a>00516             scratch[5].i = scratch_in[5].r;
<a name="l00517"></a>00517 
<a name="l00518"></a>00518             scratch[6].r = scratch_in[6].r;
<a name="l00519"></a>00519             scratch[6].i = scratch_in[6].i;
<a name="l00520"></a>00520             scratch[7].r = (scratch_in[7].r + scratch_in[7].i) * TW_81N;
<a name="l00521"></a>00521             scratch[7].i = (scratch_in[7].i - scratch_in[7].r) * TW_81N;
<a name="l00522"></a>00522 
<a name="l00523"></a>00523             <span class="comment">// radix 2 butterfly</span>
<a name="l00524"></a>00524             scratch[8].r = scratch[0].r + scratch[4].r;
<a name="l00525"></a>00525             scratch[8].i = scratch[0].i + scratch[4].i;
<a name="l00526"></a>00526             scratch[9].r = scratch[1].r + scratch[5].r;
<a name="l00527"></a>00527             scratch[9].i = scratch[1].i + scratch[5].i;
<a name="l00528"></a>00528 
<a name="l00529"></a>00529             scratch[10].r = scratch[0].r - scratch[4].r;
<a name="l00530"></a>00530             scratch[10].i = scratch[0].i - scratch[4].i;
<a name="l00531"></a>00531             scratch[11].r = scratch[1].r - scratch[5].r;
<a name="l00532"></a>00532             scratch[11].i = scratch[1].i - scratch[5].i;
<a name="l00533"></a>00533 
<a name="l00534"></a>00534             <span class="comment">// radix 2 butterfly</span>
<a name="l00535"></a>00535             scratch[12].r = scratch[2].r + scratch[6].r;
<a name="l00536"></a>00536             scratch[12].i = scratch[2].i + scratch[6].i;
<a name="l00537"></a>00537             scratch[13].r = scratch[3].r + scratch[7].r;
<a name="l00538"></a>00538             scratch[13].i = scratch[3].i + scratch[7].i;
<a name="l00539"></a>00539 
<a name="l00540"></a>00540             scratch[14].r = scratch[2].r - scratch[6].r;
<a name="l00541"></a>00541             scratch[14].i = scratch[2].i - scratch[6].i;
<a name="l00542"></a>00542             scratch[15].r = scratch[3].r - scratch[7].r;
<a name="l00543"></a>00543             scratch[15].i = scratch[3].i - scratch[7].i;
<a name="l00544"></a>00544 
<a name="l00545"></a>00545             <span class="comment">// third result</span>
<a name="l00546"></a>00546             scratch_out[4].r = scratch[8].r - scratch[12].r;
<a name="l00547"></a>00547             scratch_out[4].i = scratch[8].i - scratch[12].i;
<a name="l00548"></a>00548             scratch_out[5].r = scratch[9].r - scratch[13].r;
<a name="l00549"></a>00549             scratch_out[5].i = scratch[9].i - scratch[13].i;
<a name="l00550"></a>00550 
<a name="l00551"></a>00551             <span class="comment">// first result</span>
<a name="l00552"></a>00552             scratch_out[0].r = scratch[8].r + scratch[12].r;
<a name="l00553"></a>00553             scratch_out[0].i = scratch[8].i + scratch[12].i;
<a name="l00554"></a>00554             scratch_out[1].r = scratch[9].r + scratch[13].r;
<a name="l00555"></a>00555             scratch_out[1].i = scratch[9].i + scratch[13].i;
<a name="l00556"></a>00556 
<a name="l00557"></a>00557             <span class="comment">// second result</span>
<a name="l00558"></a>00558             scratch_out[2].r = scratch[10].r - scratch[14].i;
<a name="l00559"></a>00559             scratch_out[2].i = scratch[10].i + scratch[14].r;
<a name="l00560"></a>00560             scratch_out[3].r = scratch[11].r - scratch[15].i;
<a name="l00561"></a>00561             scratch_out[3].i = scratch[11].i + scratch[15].r;
<a name="l00562"></a>00562 
<a name="l00563"></a>00563             <span class="comment">// forth result</span>
<a name="l00564"></a>00564             scratch_out[6].r = scratch[10].r + scratch[14].i;
<a name="l00565"></a>00565             scratch_out[6].i = scratch[10].i - scratch[14].r;
<a name="l00566"></a>00566             scratch_out[7].r = scratch[11].r + scratch[15].i;
<a name="l00567"></a>00567             scratch_out[7].i = scratch[11].i - scratch[15].r;
<a name="l00568"></a>00568 
<a name="l00569"></a>00569             <span class="comment">// store</span>
<a name="l00570"></a>00570             Fout1[0] = scratch_out[0];
<a name="l00571"></a>00571             Fout1[1] = scratch_out[1];
<a name="l00572"></a>00572             Fout1[2] = scratch_out[2];
<a name="l00573"></a>00573             Fout1[3] = scratch_out[3];
<a name="l00574"></a>00574             Fout1[4] = scratch_out[4];
<a name="l00575"></a>00575             Fout1[5] = scratch_out[5];
<a name="l00576"></a>00576             Fout1[6] = scratch_out[6];
<a name="l00577"></a>00577             Fout1[7] = scratch_out[7];
<a name="l00578"></a>00578 
<a name="l00579"></a>00579             Fin1 += 1;
<a name="l00580"></a>00580         } <span class="comment">// f_count</span>
<a name="l00581"></a>00581         tw += 6;
<a name="l00582"></a>00582         mstride &lt;&lt;= 2;
<a name="l00583"></a>00583         fstride &gt;&gt;= 4;
<a name="l00584"></a>00584         stage_count -= 2;
<a name="l00585"></a>00585 
<a name="l00586"></a>00586         <span class="keywordflow">if</span> (stage_count == 0)
<a name="l00587"></a>00587         {
<a name="l00588"></a>00588             <span class="keywordflow">for</span> (f_count = 0; f_count &lt; 8; f_count++)
<a name="l00589"></a>00589             {
<a name="l00590"></a>00590                 Fout[f_count].r *= one_by_nfft;
<a name="l00591"></a>00591                 Fout[f_count].i *= one_by_nfft;
<a name="l00592"></a>00592             }
<a name="l00593"></a>00593         }
<a name="l00594"></a>00594 
<a name="l00595"></a>00595         <span class="comment">// swap</span>
<a name="l00596"></a>00596         Ftmp = buffer;
<a name="l00597"></a>00597         buffer = Fout;
<a name="l00598"></a>00598         Fout = Ftmp;
<a name="l00599"></a>00599     }
<a name="l00600"></a>00600     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N == 4)   <span class="comment">// length of FFT is 2^n (n is even)</span>
<a name="l00601"></a>00601     {
<a name="l00602"></a>00602         <span class="comment">//fstride is nfft&gt;&gt;2</span>
<a name="l00603"></a>00603         <span class="keywordflow">for</span> (f_count = fstride; f_count ; f_count --)
<a name="l00604"></a>00604         {
<a name="l00605"></a>00605             <span class="comment">// load</span>
<a name="l00606"></a>00606             scratch_in[0] = *Fin1;
<a name="l00607"></a>00607             Fin2 = Fin1 + fstride;
<a name="l00608"></a>00608             scratch_in[1] = *Fin2;
<a name="l00609"></a>00609             Fin2 = Fin2 + fstride;
<a name="l00610"></a>00610             scratch_in[2] = *Fin2;
<a name="l00611"></a>00611             Fin2 = Fin2 + fstride;
<a name="l00612"></a>00612             scratch_in[3] = *Fin2;
<a name="l00613"></a>00613 
<a name="l00614"></a>00614             <span class="comment">// radix 4 butterfly without twiddles</span>
<a name="l00615"></a>00615 
<a name="l00616"></a>00616             <span class="comment">// radix 2 butterfly</span>
<a name="l00617"></a>00617             scratch[0].r = scratch_in[0].r + scratch_in[2].r;
<a name="l00618"></a>00618             scratch[0].i = scratch_in[0].i + scratch_in[2].i;
<a name="l00619"></a>00619 
<a name="l00620"></a>00620             scratch[1].r = scratch_in[0].r - scratch_in[2].r;
<a name="l00621"></a>00621             scratch[1].i = scratch_in[0].i - scratch_in[2].i;
<a name="l00622"></a>00622 
<a name="l00623"></a>00623             <span class="comment">// radix 2 butterfly</span>
<a name="l00624"></a>00624             scratch[2].r = scratch_in[1].r + scratch_in[3].r;
<a name="l00625"></a>00625             scratch[2].i = scratch_in[1].i + scratch_in[3].i;
<a name="l00626"></a>00626 
<a name="l00627"></a>00627             scratch[3].r = scratch_in[1].r - scratch_in[3].r;
<a name="l00628"></a>00628             scratch[3].i = scratch_in[1].i - scratch_in[3].i;
<a name="l00629"></a>00629 
<a name="l00630"></a>00630             <span class="comment">// third result</span>
<a name="l00631"></a>00631             scratch_out[2].r = scratch[0].r - scratch[2].r;
<a name="l00632"></a>00632             scratch_out[2].i = scratch[0].i - scratch[2].i;
<a name="l00633"></a>00633 
<a name="l00634"></a>00634             <span class="comment">// first result</span>
<a name="l00635"></a>00635             scratch_out[0].r = scratch[0].r + scratch[2].r;
<a name="l00636"></a>00636             scratch_out[0].i = scratch[0].i + scratch[2].i;
<a name="l00637"></a>00637 
<a name="l00638"></a>00638             <span class="comment">// second result</span>
<a name="l00639"></a>00639             scratch_out[1].r = scratch[1].r - scratch[3].i;
<a name="l00640"></a>00640             scratch_out[1].i = scratch[1].i + scratch[3].r;
<a name="l00641"></a>00641 
<a name="l00642"></a>00642             <span class="comment">// forth result</span>
<a name="l00643"></a>00643             scratch_out[3].r = scratch[1].r + scratch[3].i;
<a name="l00644"></a>00644             scratch_out[3].i = scratch[1].i - scratch[3].r;
<a name="l00645"></a>00645 
<a name="l00646"></a>00646             <span class="comment">// store</span>
<a name="l00647"></a>00647             * Fout1 ++ = scratch_out[0];
<a name="l00648"></a>00648             * Fout1 ++ = scratch_out[1];
<a name="l00649"></a>00649             * Fout1 ++ = scratch_out[2];
<a name="l00650"></a>00650             * Fout1 ++ = scratch_out[3];
<a name="l00651"></a>00651 
<a name="l00652"></a>00652             Fin1++;
<a name="l00653"></a>00653         } <span class="comment">// f_count</span>
<a name="l00654"></a>00654 
<a name="l00655"></a>00655         N = fstride; <span class="comment">// 1/4 of length of FFT</span>
<a name="l00656"></a>00656 
<a name="l00657"></a>00657         <span class="comment">// update address for other stages</span>
<a name="l00658"></a>00658         stage_count--;
<a name="l00659"></a>00659         tw = twiddles;
<a name="l00660"></a>00660         fstride &gt;&gt;= 2;
<a name="l00661"></a>00661 
<a name="l00662"></a>00662         <span class="keywordflow">if</span> (stage_count == 0)
<a name="l00663"></a>00663         {
<a name="l00664"></a>00664             <span class="keywordflow">for</span> (f_count = 0; f_count &lt; 4; f_count++)
<a name="l00665"></a>00665             {
<a name="l00666"></a>00666                 Fout[f_count].r *= one_by_nfft;
<a name="l00667"></a>00667                 Fout[f_count].i *= one_by_nfft;
<a name="l00668"></a>00668             }
<a name="l00669"></a>00669         }
<a name="l00670"></a>00670         <span class="comment">// swap</span>
<a name="l00671"></a>00671         Ftmp = buffer;
<a name="l00672"></a>00672         buffer = Fout;
<a name="l00673"></a>00673         Fout = Ftmp;
<a name="l00674"></a>00674         <span class="comment">// end of first stage</span>
<a name="l00675"></a>00675     }
<a name="l00676"></a>00676 
<a name="l00677"></a>00677 
<a name="l00678"></a>00678     <span class="comment">// others but the last one</span>
<a name="l00679"></a>00679     <span class="keywordflow">for</span> (; stage_count &gt; 1 ; stage_count--)
<a name="l00680"></a>00680     {
<a name="l00681"></a>00681         Fin1 = buffer;
<a name="l00682"></a>00682         <span class="keywordflow">for</span> (f_count = 0; f_count &lt; fstride; f_count ++)
<a name="l00683"></a>00683         {
<a name="l00684"></a>00684             Fout1 = &amp; Fout[ f_count * mstride &lt;&lt; 2 ];
<a name="l00685"></a>00685             tw1 = tw;
<a name="l00686"></a>00686             <span class="keywordflow">for</span> (m_count = mstride; m_count ; m_count --)
<a name="l00687"></a>00687             {
<a name="l00688"></a>00688                 <span class="comment">// load</span>
<a name="l00689"></a>00689                 scratch_tw[0] = *tw1;
<a name="l00690"></a>00690                 tw2 = tw1 + mstride;
<a name="l00691"></a>00691                 scratch_tw[1] = *tw2;
<a name="l00692"></a>00692                 tw2 += mstride;
<a name="l00693"></a>00693                 scratch_tw[2] = *tw2;
<a name="l00694"></a>00694                 scratch_in[0] = * Fin1;
<a name="l00695"></a>00695                 Fin2 = Fin1 + N;
<a name="l00696"></a>00696                 scratch_in[1] = * Fin2;
<a name="l00697"></a>00697                 Fin2 += N;
<a name="l00698"></a>00698                 scratch_in[2] = * Fin2;
<a name="l00699"></a>00699                 Fin2 += N;
<a name="l00700"></a>00700                 scratch_in[3] = * Fin2;
<a name="l00701"></a>00701 
<a name="l00702"></a>00702                 <span class="comment">// radix 4 butterfly with twiddles</span>
<a name="l00703"></a>00703 
<a name="l00704"></a>00704                 scratch[0] = scratch_in[0];
<a name="l00705"></a>00705                 scratch[1].r = scratch_in[1].r * scratch_tw[0].r + scratch_in[1].i * scratch_tw[0].i;
<a name="l00706"></a>00706                 scratch[1].i = scratch_in[1].i * scratch_tw[0].r - scratch_in[1].r * scratch_tw[0].i;
<a name="l00707"></a>00707 
<a name="l00708"></a>00708                 scratch[2].r = scratch_in[2].r * scratch_tw[1].r + scratch_in[2].i * scratch_tw[1].i;
<a name="l00709"></a>00709                 scratch[2].i = scratch_in[2].i * scratch_tw[1].r - scratch_in[2].r * scratch_tw[1].i;
<a name="l00710"></a>00710 
<a name="l00711"></a>00711                 scratch[3].r = scratch_in[3].r * scratch_tw[2].r + scratch_in[3].i * scratch_tw[2].i;
<a name="l00712"></a>00712                 scratch[3].i = scratch_in[3].i * scratch_tw[2].r - scratch_in[3].r * scratch_tw[2].i;
<a name="l00713"></a>00713 
<a name="l00714"></a>00714                 <span class="comment">// radix 2 butterfly</span>
<a name="l00715"></a>00715                 scratch[4].r = scratch[0].r + scratch[2].r;
<a name="l00716"></a>00716                 scratch[4].i = scratch[0].i + scratch[2].i;
<a name="l00717"></a>00717 
<a name="l00718"></a>00718                 scratch[5].r = scratch[0].r - scratch[2].r;
<a name="l00719"></a>00719                 scratch[5].i = scratch[0].i - scratch[2].i;
<a name="l00720"></a>00720 
<a name="l00721"></a>00721                 <span class="comment">// radix 2 butterfly</span>
<a name="l00722"></a>00722                 scratch[6].r = scratch[1].r + scratch[3].r;
<a name="l00723"></a>00723                 scratch[6].i = scratch[1].i + scratch[3].i;
<a name="l00724"></a>00724 
<a name="l00725"></a>00725                 scratch[7].r = scratch[1].r - scratch[3].r;
<a name="l00726"></a>00726                 scratch[7].i = scratch[1].i - scratch[3].i;
<a name="l00727"></a>00727 
<a name="l00728"></a>00728                 <span class="comment">// third result</span>
<a name="l00729"></a>00729                 scratch_out[2].r = scratch[4].r - scratch[6].r;
<a name="l00730"></a>00730                 scratch_out[2].i = scratch[4].i - scratch[6].i;
<a name="l00731"></a>00731 
<a name="l00732"></a>00732                 <span class="comment">// first result</span>
<a name="l00733"></a>00733                 scratch_out[0].r = scratch[4].r + scratch[6].r;
<a name="l00734"></a>00734                 scratch_out[0].i = scratch[4].i + scratch[6].i;
<a name="l00735"></a>00735 
<a name="l00736"></a>00736                 <span class="comment">// second result</span>
<a name="l00737"></a>00737                 scratch_out[1].r = scratch[5].r - scratch[7].i;
<a name="l00738"></a>00738                 scratch_out[1].i = scratch[5].i + scratch[7].r;
<a name="l00739"></a>00739 
<a name="l00740"></a>00740                 <span class="comment">// forth result</span>
<a name="l00741"></a>00741                 scratch_out[3].r = scratch[5].r + scratch[7].i;
<a name="l00742"></a>00742                 scratch_out[3].i = scratch[5].i - scratch[7].r;
<a name="l00743"></a>00743 
<a name="l00744"></a>00744                 <span class="comment">// store</span>
<a name="l00745"></a>00745                 *Fout1 = scratch_out[0];
<a name="l00746"></a>00746                 Fout2 = Fout1 + mstride;
<a name="l00747"></a>00747                 *Fout2 = scratch_out[1];
<a name="l00748"></a>00748                 Fout2 += mstride;
<a name="l00749"></a>00749                 *Fout2 = scratch_out[2];
<a name="l00750"></a>00750                 Fout2 += mstride;
<a name="l00751"></a>00751                 *Fout2 = scratch_out[3];
<a name="l00752"></a>00752 
<a name="l00753"></a>00753                 tw1++;
<a name="l00754"></a>00754                 Fin1 ++;
<a name="l00755"></a>00755                 Fout1 ++;
<a name="l00756"></a>00756             } <span class="comment">// m_count</span>
<a name="l00757"></a>00757         } <span class="comment">// f_count</span>
<a name="l00758"></a>00758         tw += mstride * 3;
<a name="l00759"></a>00759         mstride &lt;&lt;= 2;
<a name="l00760"></a>00760         fstride &gt;&gt;= 2;
<a name="l00761"></a>00761 
<a name="l00762"></a>00762         <span class="comment">// swap</span>
<a name="l00763"></a>00763         Ftmp = buffer;
<a name="l00764"></a>00764         buffer = Fout;
<a name="l00765"></a>00765         Fout = Ftmp;
<a name="l00766"></a>00766     } <span class="comment">// stage_count</span>
<a name="l00767"></a>00767 
<a name="l00768"></a>00768     <span class="comment">// the last one</span>
<a name="l00769"></a>00769     <span class="keywordflow">if</span> (stage_count)
<a name="l00770"></a>00770     {
<a name="l00771"></a>00771         Fin1 = buffer;
<a name="l00772"></a>00772         <span class="comment">// if stage count is even, output to the input array</span>
<a name="l00773"></a>00773         Fout1 = Fout_ls;
<a name="l00774"></a>00774 
<a name="l00775"></a>00775         <span class="keywordflow">for</span> (f_count = 0; f_count &lt; fstride; f_count ++)
<a name="l00776"></a>00776         {
<a name="l00777"></a>00777             tw1 = tw;
<a name="l00778"></a>00778             <span class="keywordflow">for</span> (m_count = mstride; m_count ; m_count --)
<a name="l00779"></a>00779             {
<a name="l00780"></a>00780                 <span class="comment">// load</span>
<a name="l00781"></a>00781                 scratch_tw[0] = *tw1;
<a name="l00782"></a>00782                 tw2 = tw1 + mstride;
<a name="l00783"></a>00783                 scratch_tw[1] = *tw2;
<a name="l00784"></a>00784                 tw2 += mstride;
<a name="l00785"></a>00785                 scratch_tw[2] = *tw2;
<a name="l00786"></a>00786                 scratch_in[0] = * Fin1;
<a name="l00787"></a>00787                 Fin2 = Fin1 + N;
<a name="l00788"></a>00788                 scratch_in[1] = * Fin2;
<a name="l00789"></a>00789                 Fin2 += N;
<a name="l00790"></a>00790                 scratch_in[2] = * Fin2;
<a name="l00791"></a>00791                 Fin2 += N;
<a name="l00792"></a>00792                 scratch_in[3] = * Fin2;
<a name="l00793"></a>00793 
<a name="l00794"></a>00794                 <span class="comment">// radix 4 butterfly with twiddles</span>
<a name="l00795"></a>00795 
<a name="l00796"></a>00796                 scratch[0] = scratch_in[0];
<a name="l00797"></a>00797                 scratch[1].r = scratch_in[1].r * scratch_tw[0].r + scratch_in[1].i * scratch_tw[0].i;
<a name="l00798"></a>00798                 scratch[1].i = scratch_in[1].i * scratch_tw[0].r - scratch_in[1].r * scratch_tw[0].i;
<a name="l00799"></a>00799 
<a name="l00800"></a>00800                 scratch[2].r = scratch_in[2].r * scratch_tw[1].r + scratch_in[2].i * scratch_tw[1].i;
<a name="l00801"></a>00801                 scratch[2].i = scratch_in[2].i * scratch_tw[1].r - scratch_in[2].r * scratch_tw[1].i;
<a name="l00802"></a>00802 
<a name="l00803"></a>00803                 scratch[3].r = scratch_in[3].r * scratch_tw[2].r + scratch_in[3].i * scratch_tw[2].i;
<a name="l00804"></a>00804                 scratch[3].i = scratch_in[3].i * scratch_tw[2].r - scratch_in[3].r * scratch_tw[2].i;
<a name="l00805"></a>00805 
<a name="l00806"></a>00806                 <span class="comment">// radix 2 butterfly</span>
<a name="l00807"></a>00807                 scratch[4].r = scratch[0].r + scratch[2].r;
<a name="l00808"></a>00808                 scratch[4].i = scratch[0].i + scratch[2].i;
<a name="l00809"></a>00809 
<a name="l00810"></a>00810                 scratch[5].r = scratch[0].r - scratch[2].r;
<a name="l00811"></a>00811                 scratch[5].i = scratch[0].i - scratch[2].i;
<a name="l00812"></a>00812 
<a name="l00813"></a>00813                 <span class="comment">// radix 2 butterfly</span>
<a name="l00814"></a>00814                 scratch[6].r = scratch[1].r + scratch[3].r;
<a name="l00815"></a>00815                 scratch[6].i = scratch[1].i + scratch[3].i;
<a name="l00816"></a>00816 
<a name="l00817"></a>00817                 scratch[7].r = scratch[1].r - scratch[3].r;
<a name="l00818"></a>00818                 scratch[7].i = scratch[1].i - scratch[3].i;
<a name="l00819"></a>00819 
<a name="l00820"></a>00820                 <span class="comment">// third result</span>
<a name="l00821"></a>00821                 scratch_out[2].r = (scratch[4].r - scratch[6].r) * one_by_nfft;
<a name="l00822"></a>00822                 scratch_out[2].i = (scratch[4].i - scratch[6].i) * one_by_nfft;
<a name="l00823"></a>00823 
<a name="l00824"></a>00824                 <span class="comment">// first result</span>
<a name="l00825"></a>00825                 scratch_out[0].r = (scratch[4].r + scratch[6].r) * one_by_nfft;
<a name="l00826"></a>00826                 scratch_out[0].i = (scratch[4].i + scratch[6].i) * one_by_nfft;
<a name="l00827"></a>00827 
<a name="l00828"></a>00828                 <span class="comment">// second result</span>
<a name="l00829"></a>00829                 scratch_out[1].r = (scratch[5].r - scratch[7].i) * one_by_nfft;
<a name="l00830"></a>00830                 scratch_out[1].i = (scratch[5].i + scratch[7].r) * one_by_nfft;
<a name="l00831"></a>00831 
<a name="l00832"></a>00832                 <span class="comment">// forth result</span>
<a name="l00833"></a>00833                 scratch_out[3].r = (scratch[5].r + scratch[7].i) * one_by_nfft;
<a name="l00834"></a>00834                 scratch_out[3].i = (scratch[5].i - scratch[7].r) * one_by_nfft;
<a name="l00835"></a>00835 
<a name="l00836"></a>00836                 <span class="comment">// store</span>
<a name="l00837"></a>00837                 *Fout1 = scratch_out[0];
<a name="l00838"></a>00838                 Fout2 = Fout1 + N;
<a name="l00839"></a>00839                 *Fout2 = scratch_out[1];
<a name="l00840"></a>00840                 Fout2 += N;
<a name="l00841"></a>00841                 *Fout2 = scratch_out[2];
<a name="l00842"></a>00842                 Fout2 += N;
<a name="l00843"></a>00843                 *Fout2 = scratch_out[3];
<a name="l00844"></a>00844 
<a name="l00845"></a>00845                 tw1 ++;
<a name="l00846"></a>00846                 Fin1 ++;
<a name="l00847"></a>00847                 Fout1 ++;
<a name="l00848"></a>00848             } <span class="comment">// m_count</span>
<a name="l00849"></a>00849         } <span class="comment">// f_count</span>
<a name="l00850"></a>00850     } <span class="comment">// last stage</span>
<a name="l00851"></a>00851 }
<a name="l00852"></a>00852 
<a name="l00853"></a>00853 <span class="keyword">static</span> <span class="keywordtype">void</span> ne10_fft_split_r2c_1d_float32 (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *dst,
<a name="l00854"></a>00854         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *src,
<a name="l00855"></a>00855         <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles,
<a name="l00856"></a>00856         ne10_int32_t ncfft)
<a name="l00857"></a>00857 {
<a name="l00858"></a>00858     ne10_int32_t k;
<a name="l00859"></a>00859     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> fpnk, fpk, f1k, f2k, tw, tdc;
<a name="l00860"></a>00860 
<a name="l00861"></a>00861     tdc.r = src[0].r;
<a name="l00862"></a>00862     tdc.i = src[0].i;
<a name="l00863"></a>00863 
<a name="l00864"></a>00864     dst[0].r = tdc.r + tdc.i;
<a name="l00865"></a>00865     dst[ncfft].r = tdc.r - tdc.i;
<a name="l00866"></a>00866     dst[ncfft].i = dst[0].i = 0;
<a name="l00867"></a>00867 
<a name="l00868"></a>00868     <span class="keywordflow">for</span> (k = 1; k &lt;= ncfft / 2 ; ++k)
<a name="l00869"></a>00869     {
<a name="l00870"></a>00870         fpk    = src[k];
<a name="l00871"></a>00871         fpnk.r =   src[ncfft - k].r;
<a name="l00872"></a>00872         fpnk.i = - src[ncfft - k].i;
<a name="l00873"></a>00873 
<a name="l00874"></a>00874         f1k.r = fpk.r + fpnk.r;
<a name="l00875"></a>00875         f1k.i = fpk.i + fpnk.i;
<a name="l00876"></a>00876 
<a name="l00877"></a>00877         f2k.r = fpk.r - fpnk.r;
<a name="l00878"></a>00878         f2k.i = fpk.i - fpnk.i;
<a name="l00879"></a>00879 
<a name="l00880"></a>00880         tw.r = f2k.r * (twiddles[k - 1]).r - f2k.i * (twiddles[k - 1]).i;
<a name="l00881"></a>00881         tw.i = f2k.r * (twiddles[k - 1]).i + f2k.i * (twiddles[k - 1]).r;
<a name="l00882"></a>00882 
<a name="l00883"></a>00883         dst[k].r = (f1k.r + tw.r) * 0.5f;
<a name="l00884"></a>00884         dst[k].i = (f1k.i + tw.i) * 0.5f;
<a name="l00885"></a>00885         dst[ncfft - k].r = (f1k.r - tw.r) * 0.5f;
<a name="l00886"></a>00886         dst[ncfft - k].i = (tw.i - f1k.i) * 0.5f;
<a name="l00887"></a>00887     }
<a name="l00888"></a>00888 }
<a name="l00889"></a>00889 
<a name="l00890"></a>00890 <span class="keyword">static</span> <span class="keywordtype">void</span> ne10_fft_split_c2r_1d_float32 (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *dst,
<a name="l00891"></a>00891         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *src,
<a name="l00892"></a>00892         <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles,
<a name="l00893"></a>00893         ne10_int32_t ncfft)
<a name="l00894"></a>00894 {
<a name="l00895"></a>00895 
<a name="l00896"></a>00896     ne10_int32_t k;
<a name="l00897"></a>00897     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> fk, fnkc, fek, fok, tmp;
<a name="l00898"></a>00898 
<a name="l00899"></a>00899 
<a name="l00900"></a>00900     dst[0].r = (src[0].r + src[ncfft].r) * 0.5f;
<a name="l00901"></a>00901     dst[0].i = (src[0].r - src[ncfft].r) * 0.5f;
<a name="l00902"></a>00902 
<a name="l00903"></a>00903     <span class="keywordflow">for</span> (k = 1; k &lt;= ncfft / 2; k++)
<a name="l00904"></a>00904     {
<a name="l00905"></a>00905         fk = src[k];
<a name="l00906"></a>00906         fnkc.r = src[ncfft - k].r;
<a name="l00907"></a>00907         fnkc.i = -src[ncfft - k].i;
<a name="l00908"></a>00908 
<a name="l00909"></a>00909         fek.r = fk.r + fnkc.r;
<a name="l00910"></a>00910         fek.i = fk.i + fnkc.i;
<a name="l00911"></a>00911 
<a name="l00912"></a>00912         tmp.r = fk.r - fnkc.r;
<a name="l00913"></a>00913         tmp.i = fk.i - fnkc.i;
<a name="l00914"></a>00914 
<a name="l00915"></a>00915         fok.r = tmp.r * twiddles[k - 1].r + tmp.i * twiddles[k - 1].i;
<a name="l00916"></a>00916         fok.i = tmp.i * twiddles[k - 1].r - tmp.r * twiddles[k - 1].i;
<a name="l00917"></a>00917 
<a name="l00918"></a>00918         dst[k].r = (fek.r + fok.r) * 0.5f;
<a name="l00919"></a>00919         dst[k].i = (fek.i + fok.i) * 0.5f;
<a name="l00920"></a>00920 
<a name="l00921"></a>00921         dst[ncfft - k].r = (fek.r - fok.r) * 0.5f;
<a name="l00922"></a>00922         dst[ncfft - k].i = (fok.i - fek.i) * 0.5f;
<a name="l00923"></a>00923     }
<a name="l00924"></a>00924 }
<a name="l00925"></a>00925 
<a name="l00999"></a><a class="code" href="group__C2C__FFT__IFFT.html#gadf681ba4e27770ed9aa097b4bc29372d">00999</a> <a class="code" href="structne10__fft__state__float32__t.html">ne10_fft_cfg_float32_t</a> <a class="code" href="group__C2C__FFT__IFFT.html#gadf681ba4e27770ed9aa097b4bc29372d" title="User-callable function to allocate all necessary storage space for the fft.">ne10_fft_alloc_c2c_float32_c</a> (ne10_int32_t nfft)
<a name="l01000"></a>01000 {
<a name="l01001"></a>01001     <a class="code" href="structne10__fft__state__float32__t.html">ne10_fft_cfg_float32_t</a> st = NULL;
<a name="l01002"></a>01002     ne10_uint32_t memneeded = <span class="keyword">sizeof</span> (<a class="code" href="structne10__fft__state__float32__t.html">ne10_fft_state_float32_t</a>)
<a name="l01003"></a>01003                               + <span class="keyword">sizeof</span> (ne10_int32_t) * (NE10_MAXFACTORS * 2) <span class="comment">/* factors*/</span>
<a name="l01004"></a>01004                               + <span class="keyword">sizeof</span> (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>) * nfft        <span class="comment">/* twiddle*/</span>
<a name="l01005"></a>01005                               + <span class="keyword">sizeof</span> (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>) * nfft        <span class="comment">/* buffer*/</span>
<a name="l01006"></a>01006                               + NE10_FFT_BYTE_ALIGNMENT;     <span class="comment">/* 64-bit alignment*/</span>
<a name="l01007"></a>01007 
<a name="l01008"></a>01008     st = (<a class="code" href="structne10__fft__state__float32__t.html">ne10_fft_cfg_float32_t</a>) NE10_MALLOC (memneeded);
<a name="l01009"></a>01009 
<a name="l01010"></a>01010     <span class="keywordflow">if</span> (st == NULL)
<a name="l01011"></a>01011     {
<a name="l01012"></a>01012         <span class="keywordflow">return</span> st;
<a name="l01013"></a>01013     }
<a name="l01014"></a>01014 
<a name="l01015"></a>01015     uintptr_t address = (uintptr_t) st + <span class="keyword">sizeof</span> (<a class="code" href="structne10__fft__state__float32__t.html">ne10_fft_state_float32_t</a>);
<a name="l01016"></a>01016     NE10_BYTE_ALIGNMENT (address, NE10_FFT_BYTE_ALIGNMENT);
<a name="l01017"></a>01017     st-&gt;factors = (ne10_int32_t*) address;
<a name="l01018"></a>01018     st-&gt;twiddles = (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>*) (st-&gt;factors + (NE10_MAXFACTORS * 2));
<a name="l01019"></a>01019     st-&gt;buffer = st-&gt;twiddles + nfft;
<a name="l01020"></a>01020     st-&gt;nfft = nfft;
<a name="l01021"></a>01021 
<a name="l01022"></a>01022     ne10_int32_t result = ne10_factor (nfft, st-&gt;factors, NE10_FACTOR_DEFAULT);
<a name="l01023"></a>01023     <span class="keywordflow">if</span> (result == NE10_ERR)
<a name="l01024"></a>01024     {
<a name="l01025"></a>01025         NE10_FREE (st);
<a name="l01026"></a>01026         <span class="keywordflow">return</span> st;
<a name="l01027"></a>01027     }
<a name="l01028"></a>01028 
<a name="l01029"></a>01029     <span class="comment">// Check if ALGORITHM FLAG is NE10_FFT_ALG_ANY.</span>
<a name="l01030"></a>01030     {
<a name="l01031"></a>01031         ne10_int32_t stage_count    = st-&gt;factors[0];
<a name="l01032"></a>01032         ne10_int32_t algorithm_flag = st-&gt;factors[2 * (stage_count + 1)];
<a name="l01033"></a>01033 
<a name="l01034"></a>01034         <span class="comment">// Enable radix-8.</span>
<a name="l01035"></a>01035         <span class="keywordflow">if</span> (algorithm_flag == NE10_FFT_ALG_ANY)
<a name="l01036"></a>01036         {
<a name="l01037"></a>01037             result = ne10_factor (st-&gt;nfft, st-&gt;factors, NE10_FACTOR_EIGHT);
<a name="l01038"></a>01038             <span class="keywordflow">if</span> (result == NE10_ERR)
<a name="l01039"></a>01039             {
<a name="l01040"></a>01040                 PRINT_HIT;
<a name="l01041"></a>01041                 NE10_FREE (st);
<a name="l01042"></a>01042                 <span class="keywordflow">return</span> st;
<a name="l01043"></a>01043             }
<a name="l01044"></a>01044         }
<a name="l01045"></a>01045     }
<a name="l01046"></a>01046 
<a name="l01047"></a>01047     ne10_fft_generate_twiddles_float32 (st-&gt;twiddles, st-&gt;factors, nfft);
<a name="l01048"></a>01048 
<a name="l01049"></a>01049     <span class="keywordflow">return</span> st;
<a name="l01050"></a>01050 }
<a name="l01051"></a>01051 
<a name="l01063"></a><a class="code" href="group__C2C__FFT__IFFT.html#ga8a03f9824ed0ccc270ce39c0eab1a658">01063</a> <span class="keywordtype">void</span> <a class="code" href="group__C2C__FFT__IFFT.html#ga8a03f9824ed0ccc270ce39c0eab1a658" title="Mixed radix-2/3/4/5 complex FFT/IFFT of float(32-bit) data.">ne10_fft_c2c_1d_float32_c</a> (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *fout,
<a name="l01064"></a>01064                                 <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *fin,
<a name="l01065"></a>01065                                 <a class="code" href="structne10__fft__state__float32__t.html">ne10_fft_cfg_float32_t</a> cfg,
<a name="l01066"></a>01066                                 ne10_int32_t inverse_fft)
<a name="l01067"></a>01067 {
<a name="l01068"></a>01068     ne10_int32_t stage_count = cfg-&gt;factors[0];
<a name="l01069"></a>01069     ne10_int32_t algorithm_flag = cfg-&gt;factors[2 * (stage_count + 1)];
<a name="l01070"></a>01070 
<a name="l01071"></a>01071     assert ((algorithm_flag == NE10_FFT_ALG_24)
<a name="l01072"></a>01072             || (algorithm_flag == NE10_FFT_ALG_ANY));
<a name="l01073"></a>01073 
<a name="l01074"></a>01074     <span class="keywordflow">switch</span> (algorithm_flag)
<a name="l01075"></a>01075     {
<a name="l01076"></a>01076     <span class="keywordflow">case</span> NE10_FFT_ALG_24:
<a name="l01077"></a>01077         <span class="keywordflow">if</span> (inverse_fft)
<a name="l01078"></a>01078         {
<a name="l01079"></a>01079             ne10_mixed_radix_butterfly_inverse_float32_c (fout, fin, cfg-&gt;factors, cfg-&gt;twiddles, cfg-&gt;buffer);
<a name="l01080"></a>01080         }
<a name="l01081"></a>01081         <span class="keywordflow">else</span>
<a name="l01082"></a>01082         {
<a name="l01083"></a>01083             ne10_mixed_radix_butterfly_float32_c (fout, fin, cfg-&gt;factors, cfg-&gt;twiddles, cfg-&gt;buffer);
<a name="l01084"></a>01084         }
<a name="l01085"></a>01085         <span class="keywordflow">break</span>;
<a name="l01086"></a>01086     <span class="keywordflow">case</span> NE10_FFT_ALG_ANY:
<a name="l01087"></a>01087         <span class="keywordflow">if</span> (inverse_fft)
<a name="l01088"></a>01088         {
<a name="l01089"></a>01089             ne10_mixed_radix_generic_butterfly_inverse_float32_c (fout, fin, cfg-&gt;factors, cfg-&gt;twiddles, cfg-&gt;buffer);
<a name="l01090"></a>01090         }
<a name="l01091"></a>01091         <span class="keywordflow">else</span>
<a name="l01092"></a>01092         {
<a name="l01093"></a>01093             ne10_mixed_radix_generic_butterfly_float32_c (fout, fin, cfg-&gt;factors, cfg-&gt;twiddles, cfg-&gt;buffer);
<a name="l01094"></a>01094         }
<a name="l01095"></a>01095         <span class="keywordflow">break</span>;
<a name="l01096"></a>01096     }
<a name="l01097"></a>01097 }
<a name="l01098"></a>01098  <span class="comment">//end of C2C_FFT_IFFT group</span>
<a name="l01102"></a>01102 
<a name="l01180"></a>01180 <span class="comment">// only for ARMv7-A and AArch32 platform.</span>
<a name="l01181"></a>01181 <span class="comment">// For AArch64 these functions are implemented in NE10_rfft_float32.c</span>
<a name="l01182"></a>01182 <span class="preprocessor">#ifdef __arm__</span>
<a name="l01183"></a>01183 <span class="preprocessor"></span>
<a name="l01184"></a>01184 <span class="comment">// RFFT reference model for ARMv7-A and AArch32 neon</span>
<a name="l01186"></a>01186 <span class="comment"></span>
<a name="l01193"></a>01193 <a class="code" href="structne10__fft__r2c__state__float32__t.html">ne10_fft_r2c_cfg_float32_t</a> ne10_fft_alloc_r2c_float32 (ne10_int32_t nfft)
<a name="l01194"></a>01194 {
<a name="l01195"></a>01195     <a class="code" href="structne10__fft__r2c__state__float32__t.html">ne10_fft_r2c_cfg_float32_t</a> st = NULL;
<a name="l01196"></a>01196     ne10_int32_t ncfft = nfft &gt;&gt; 1;
<a name="l01197"></a>01197 
<a name="l01198"></a>01198     ne10_uint32_t memneeded = <span class="keyword">sizeof</span> (<a class="code" href="structne10__fft__r2c__state__float32__t.html">ne10_fft_r2c_state_float32_t</a>)
<a name="l01199"></a>01199                               + <span class="keyword">sizeof</span> (ne10_int32_t) * (NE10_MAXFACTORS * 2) <span class="comment">/* factors */</span>
<a name="l01200"></a>01200                               + <span class="keyword">sizeof</span> (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>) * ncfft       <span class="comment">/* twiddle*/</span>
<a name="l01201"></a>01201                               + <span class="keyword">sizeof</span> (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>) * (ncfft / 2) <span class="comment">/* super twiddles*/</span>
<a name="l01202"></a>01202                               + <span class="keyword">sizeof</span> (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>) * nfft        <span class="comment">/* buffer*/</span>
<a name="l01203"></a>01203                               + NE10_FFT_BYTE_ALIGNMENT;     <span class="comment">/* 64-bit alignment*/</span>
<a name="l01204"></a>01204 
<a name="l01205"></a>01205     st = (<a class="code" href="structne10__fft__r2c__state__float32__t.html">ne10_fft_r2c_cfg_float32_t</a>) NE10_MALLOC (memneeded);
<a name="l01206"></a>01206 
<a name="l01207"></a>01207     <span class="keywordflow">if</span> (st)
<a name="l01208"></a>01208     {
<a name="l01209"></a>01209         uintptr_t address = (uintptr_t) st + <span class="keyword">sizeof</span> (<a class="code" href="structne10__fft__r2c__state__float32__t.html">ne10_fft_r2c_state_float32_t</a>);
<a name="l01210"></a>01210         NE10_BYTE_ALIGNMENT (address, NE10_FFT_BYTE_ALIGNMENT);
<a name="l01211"></a>01211         st-&gt;factors = (ne10_int32_t*) address;
<a name="l01212"></a>01212         st-&gt;twiddles = (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>*) (st-&gt;factors + (NE10_MAXFACTORS * 2));
<a name="l01213"></a>01213         st-&gt;super_twiddles = st-&gt;twiddles + ncfft;
<a name="l01214"></a>01214         st-&gt;buffer = st-&gt;super_twiddles + (ncfft / 2);
<a name="l01215"></a>01215         st-&gt;ncfft = ncfft;
<a name="l01216"></a>01216 
<a name="l01217"></a>01217         ne10_int32_t result = ne10_factor (ncfft, st-&gt;factors, NE10_FACTOR_DEFAULT);
<a name="l01218"></a>01218         <span class="keywordflow">if</span> (result == NE10_ERR)
<a name="l01219"></a>01219         {
<a name="l01220"></a>01220             NE10_FREE (st);
<a name="l01221"></a>01221             <span class="keywordflow">return</span> st;
<a name="l01222"></a>01222         }
<a name="l01223"></a>01223 
<a name="l01224"></a>01224         ne10_int32_t i, j;
<a name="l01225"></a>01225         ne10_int32_t *factors = st-&gt;factors;
<a name="l01226"></a>01226         <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles = st-&gt;twiddles;
<a name="l01227"></a>01227         <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *tw;
<a name="l01228"></a>01228         ne10_int32_t stage_count = factors[0];
<a name="l01229"></a>01229         ne10_int32_t fstride1 = factors[1];
<a name="l01230"></a>01230         ne10_int32_t fstride2 = fstride1 * 2;
<a name="l01231"></a>01231         ne10_int32_t fstride3 = fstride1 * 3;
<a name="l01232"></a>01232         ne10_int32_t m;
<a name="l01233"></a>01233 
<a name="l01234"></a>01234         <span class="keyword">const</span> ne10_float32_t pi = NE10_PI;
<a name="l01235"></a>01235         ne10_float32_t phase1;
<a name="l01236"></a>01236         ne10_float32_t phase2;
<a name="l01237"></a>01237         ne10_float32_t phase3;
<a name="l01238"></a>01238 
<a name="l01239"></a>01239         <span class="keywordflow">for</span> (i = stage_count - 1; i &gt; 0; i--)
<a name="l01240"></a>01240         {
<a name="l01241"></a>01241             fstride1 &gt;&gt;= 2;
<a name="l01242"></a>01242             fstride2 &gt;&gt;= 2;
<a name="l01243"></a>01243             fstride3 &gt;&gt;= 2;
<a name="l01244"></a>01244             m = factors[2 * i + 1];
<a name="l01245"></a>01245             tw = twiddles;
<a name="l01246"></a>01246             <span class="keywordflow">for</span> (j = 0; j &lt; m; j++)
<a name="l01247"></a>01247             {
<a name="l01248"></a>01248                 phase1 = -2 * pi * fstride1 * j / ncfft;
<a name="l01249"></a>01249                 phase2 = -2 * pi * fstride2 * j / ncfft;
<a name="l01250"></a>01250                 phase3 = -2 * pi * fstride3 * j / ncfft;
<a name="l01251"></a>01251                 tw-&gt;r = (ne10_float32_t) cos (phase1);
<a name="l01252"></a>01252                 tw-&gt;i = (ne10_float32_t) sin (phase1);
<a name="l01253"></a>01253                 (tw + m)-&gt;r = (ne10_float32_t) cos (phase2);
<a name="l01254"></a>01254                 (tw + m)-&gt;i = (ne10_float32_t) sin (phase2);
<a name="l01255"></a>01255                 (tw + m * 2)-&gt;r = (ne10_float32_t) cos (phase3);
<a name="l01256"></a>01256                 (tw + m * 2)-&gt;i = (ne10_float32_t) sin (phase3);
<a name="l01257"></a>01257                 tw++;
<a name="l01258"></a>01258             }
<a name="l01259"></a>01259             twiddles += m * 3;
<a name="l01260"></a>01260         }
<a name="l01261"></a>01261 
<a name="l01262"></a>01262         tw = st-&gt;super_twiddles;
<a name="l01263"></a>01263         <span class="keywordflow">for</span> (i = 0; i &lt; ncfft / 2; i++)
<a name="l01264"></a>01264         {
<a name="l01265"></a>01265             phase1 = -pi * ( (ne10_float32_t) (i + 1) / ncfft + 0.5f);
<a name="l01266"></a>01266             tw-&gt;r = (ne10_float32_t) cos (phase1);
<a name="l01267"></a>01267             tw-&gt;i = (ne10_float32_t) sin (phase1);
<a name="l01268"></a>01268             tw++;
<a name="l01269"></a>01269         }
<a name="l01270"></a>01270 
<a name="l01271"></a>01271     }
<a name="l01272"></a>01272     <span class="keywordflow">return</span> st;
<a name="l01273"></a>01273 }
<a name="l01274"></a>01274 
<a name="l01285"></a>01285 <span class="keywordtype">void</span> ne10_fft_r2c_1d_float32_c (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *fout,
<a name="l01286"></a>01286                                 ne10_float32_t *fin,
<a name="l01287"></a>01287                                 <a class="code" href="structne10__fft__r2c__state__float32__t.html">ne10_fft_r2c_cfg_float32_t</a> cfg)
<a name="l01288"></a>01288 {
<a name="l01289"></a>01289     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * tmpbuf = cfg-&gt;buffer;
<a name="l01290"></a>01290 
<a name="l01291"></a>01291     ne10_mixed_radix_butterfly_float32_c (tmpbuf, (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>*) fin, cfg-&gt;factors, cfg-&gt;twiddles, fout);
<a name="l01292"></a>01292     ne10_fft_split_r2c_1d_float32 (fout, tmpbuf, cfg-&gt;super_twiddles, cfg-&gt;ncfft);
<a name="l01293"></a>01293 }
<a name="l01294"></a>01294 
<a name="l01305"></a>01305 <span class="keywordtype">void</span> ne10_fft_c2r_1d_float32_c (ne10_float32_t *fout,
<a name="l01306"></a>01306                                 <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *fin,
<a name="l01307"></a>01307                                 <a class="code" href="structne10__fft__r2c__state__float32__t.html">ne10_fft_r2c_cfg_float32_t</a> cfg)
<a name="l01308"></a>01308 {
<a name="l01309"></a>01309     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * tmpbuf1 = cfg-&gt;buffer;
<a name="l01310"></a>01310     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * tmpbuf2 = cfg-&gt;buffer + cfg-&gt;ncfft;
<a name="l01311"></a>01311 
<a name="l01312"></a>01312     ne10_fft_split_c2r_1d_float32 (tmpbuf1, fin, cfg-&gt;super_twiddles, cfg-&gt;ncfft);
<a name="l01313"></a>01313     ne10_mixed_radix_butterfly_inverse_float32_c ( (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a>*) fout, tmpbuf1, cfg-&gt;factors, cfg-&gt;twiddles, tmpbuf2);
<a name="l01314"></a>01314 }
<a name="l01315"></a>01315 
<a name="l01319"></a>01319 <span class="preprocessor">#endif</span>
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Wed Jan 21 2015 18:47:14 for Project Ne10 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
